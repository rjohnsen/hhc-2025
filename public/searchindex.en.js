var relearn_searchindex = [
  {
    "breadcrumb": "Intro",
    "content": "The Counter Hack crew is in the Neighborhood festively preparing for the holidays when they are suddenly overrun by lively Gnomes in Your Home! There must have been some magic in those Gnomes, because, due to some unseen spark, some haunting hocus pocus, they have come to life and are now scurrying around the Neighborhood.",
    "description": "The Counter Hack crew is in the Neighborhood festively preparing for the holidays when they are suddenly overrun by lively Gnomes in Your Home! There must have been some magic in those Gnomes, because, due to some unseen spark, some haunting hocus pocus, they have come to life and are now scurrying around the Neighborhood.",
    "tags": [],
    "title": "Act 1",
    "uri": "/act1/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nMeet Lynn Schifano on the train for a warm welcome and get ready for your journey around the Dosis Neighborhood.\nLynn Schifano mission statement Welcome to the 2025 SANS Holiday Hack Challenge! We‚Äôre on a train heading‚Ä¶ NOT to the North Pole, but instead to The Neighborhood. Your cybersecurity skills are needed there this year! I‚Äôm here to help orient you to this year‚Äôs exciting challenge.\nI‚Äôm the Chief of Staff at Counter Hack, making sure the right people are doing the right thing at the right place at the right time ‚Äì Herding cats, in other words.\nI love sports, especially college basketball. My favorite teams are Monmouth University, Louisville, and Syracuse.\nI‚Äôm a Queens Girl living my best life at the beautiful Jersey Shore.\nI‚Äôm a proud Mom of three and Grandma of one (so far!! üôè).\nHey, think you can give this terminal a try? Just click on it and follow the instructions.\nOn one of my attempt to grab a screenshot, no character showed up:\nTerminal 1 Lynn Schifano mission debrief Great work! Please, hop off the train and explore the neighborhood.\nWe‚Äôre so glad to have you here!\nOh, one more thing! You can press Q and E to rotate the map around. It gives you a nice semi-3D view of the area - really helps when you need to look around buildings and objects. Pretty neat, right? Give it a spin!",
    "description": "Objective Difficulty: 1/5\nMeet Lynn Schifano on the train for a warm welcome and get ready for your journey around the Dosis Neighborhood.\nLynn Schifano mission statement Welcome to the 2025 SANS Holiday Hack Challenge! We‚Äôre on a train heading‚Ä¶ NOT to the North Pole, but instead to The Neighborhood. Your cybersecurity skills are needed there this year! I‚Äôm here to help orient you to this year‚Äôs exciting challenge.",
    "tags": [],
    "title": "Holiday Hack Orientation",
    "uri": "/act1/holiday-hack-orientation/index.html"
  },
  {
    "breadcrumb": "Intro",
    "content": "",
    "description": "",
    "tags": [],
    "title": "Act 2",
    "uri": "/act2/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nFind Ed Skoudis upstairs in City Hall and help him troubleshoot a clever phishing tool in his cozy office.\nEd Skoudis mission statement I‚Äôm the Founder of Counter Hack Innovations, the team that brings you the SANS Holiday Hack Challenge for the last 22 years.\nI‚Äôm also the President of the SANS Technology Institute College, which has over 2,300 students studying for their Bachelor‚Äôs Degrees, Master‚Äôs Degrees, and various certificates.\nI was the original author of the SANS SEC504 (Incident Handling and Hacker Attacks) and SANS SEC560 (Enterprise Penetration Testing) courses.\nI love Capture the Flag games and puzzles.\nI‚Äôve got a steampunk office filled with secret rooms, and I collect antique crypto systems and communication technologies.\nI‚Äôve got an original Enigma machine (A726, from the early war years), a leaf of the Gutenberg Bible (1 John 2:3 to 4:16) from 1455, and a Kryha Liliput from the 1920s.\nOh gosh, I could talk for hours about this stuff but I really need your help!\nThe team has been working on this new SOC tool that helps triage phishing emails‚Ä¶and there are some‚Ä¶issues.\nWe have had some pretty sketchy emails coming through and we need to make sure we block ALL of the indicators of compromise. Can you help me? No pressure‚Ä¶\nIts all about the defang terminal Extract IOCs (Step 1) Domain \\b(?!(?:\\d+\\.)+\\d+\\b)(?:[a-z0-9-]+\\.)+(?!(?:exe|corp)\\b)[a-z]{2,63}\\b icicleinnovations.mail mail.icicleinnovations.mail core.icicleinnovations.mail IP addresses \\b(?!(10)\\.)(?:(?:25[0-5]|2[0-4][0-9]|1?\\d{1,2})\\.){3}(?:25[0-5]|2[0-4][0-9]|1?\\d{1,2})\\b 172.16.254.1 192.168.1.1 URLs For this one I just nicked the provided regex for URLs and replaced the start http with a fuzzier version https?\nhttps?://[a-zA-Z0-9-]+(\\.[a-zA-Z0-9-]+)+(:[0-9]+)?(/[^\\s]*)? https://icicleinnovations.mail/renovation-planner.exe https://icicleinnovations.mail/upload_photos Emails The provided regex example worked like a charm:\n\\b[a-zA-Z0-9._%+-]+@(?:[A-Za-z0-9-]+\\.)+(?!corp\\b)[A-Za-z]{2,63}\\b sales@icicleinnovations.mail info@icicleinnovations.mail Defang \u0026 Report (Step 2) s/\\./[.]/g; s/@/[@]/g; s/:\\//[://]/g; s/http/hxxp/g It is worth mentioning that the system helps you in great ways on what should be submitted. For instance, upon submission you are presented with a warning like this if anything is wrong:\nUpon successful completion we see the report:\nEd Skoudis mission debrief Well you just made that look like a piece of cake! Though I prefer cookies‚Ä¶I know where to find the best in town!\nThanks again! See ya ‚Äòround!\nExtras Ed‚Äôs wild history on getting an Enigma machine I looked into this claim and found out Ed had documented it in a PDF located here: Please Keep Your Brain Juice Off My Enigma\nThe said Enigma machine:\nThe story follows cybersecurity professionals Ed Skoudis and Josh Wright as they embark on an unusual mission to purchase a genuine World War II Enigma machine. Ed first learned of a potential seller‚ÄîDr. Tom, a retired professor and Enigma enthusiast‚Äîthrough a broker named Dr. David. After earlier negotiations had stalled for unrelated personal reasons, Ed reconnected a year later and found that several Enigmas were available again.\nEd and Josh arranged a visit to Dr. Tom‚Äôs remote mountain farmhouse to personally inspect two machines. The trip required long drives for both of them, and the final stretch of road was steep and eerie, adding to the sense of adventure. Upon arrival, they were welcomed warmly by Dr. Tom and his wife, who gave them a detailed tour of the collection and took photographs throughout the visit.\nBefore making a purchase, Ed insisted on testing the Enigma‚Äôs functionality. Using an Enigma simulation app on his iPad, he encoded a message and verified that the real machine decoded it correctly. Satisfied with the test, he and Josh sat down to a surprisingly elegant lunch prepared by their hosts.\nAfter reviewing the two available units‚ÄîA2200 and A726‚Äîthey decided to purchase A726. The visit was filled with quirky moments, enthusiastic hospitality, and a sense of stepping into the home of someone deeply passionate about historical cryptography.\nThe transaction was completed successfully, and Ed and Josh left with a functioning Enigma machine and a story far more memorable than a simple equipment purchase. The narrative closes by reflecting on how the Enigma symbolizes both the deceptive confidence of flawed security and the ingenuity of those who unraveled it‚Äîwhile their journey highlights the unpredictable and strangely delightful experiences life offers.\nEd‚Äôs page It appears true that he owns a leaf of the Gutenberg Bible, according to this text found over at the Cyphercon site:",
    "description": "Objective Difficulty: 1/5\nFind Ed Skoudis upstairs in City Hall and help him troubleshoot a clever phishing tool in his cozy office.\nEd Skoudis mission statement I‚Äôm the Founder of Counter Hack Innovations, the team that brings you the SANS Holiday Hack Challenge for the last 22 years.\nI‚Äôm also the President of the SANS Technology Institute College, which has over 2,300 students studying for their Bachelor‚Äôs Degrees, Master‚Äôs Degrees, and various certificates.",
    "tags": [],
    "title": "Its All About Defang",
    "uri": "/act1/its-all-about-defang/index.html"
  },
  {
    "breadcrumb": "Intro",
    "content": "",
    "description": "",
    "tags": [],
    "title": "Act 3",
    "uri": "/act3/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nAssist Kyle at the old data center with a fire alarm that just won‚Äôt chill.\nKyle Parrish mission statement If you spot a fire, let me know! I‚Äôm Kyle, and I‚Äôve been around the Holiday Hack Challenge scene for years as arnydo - picked up multiple Super Honorable Mentions along the way.\nWhen I‚Äôm not fighting fires or hunting vulnerabilities, you‚Äôll find me on a unicycle or juggling - I once showed up a professional clown with his own clubs!\nMy family and I love exploring those East Tennessee mountains, and honestly, geocaching teaches you a lot about finding hidden things - useful in both firefighting and hacking.\nAnyway, I could use some help here. This fire alarm keeps going nuts but there‚Äôs no fire. I checked.\nI think someone has locked us out of the system. Can you see if you can get back in?\nNeigboorhood Fire Alarm System üö® EMERGENCY ALERT: Fire alarm system admin access has been compromised! üö® The fire safety systems are experiencing interference and admin privileges have been mysteriously revoked. The neighborhood‚Äôs fire protection infrastructure is at risk!\n‚ö†Ô∏è CURRENT STATUS: Limited to standard user access only üîí FIRE SAFETY SYSTEMS: Partially operational but restricted üéØ MISSION CRITICAL: Restore full fire alarm system control\nYour mission: Find a way to bypass the current restrictions and elevate to fire safety admin privileges. Once you regain full access, run the special command /etc/firealarm/restore_fire_alarm to restore complete fire alarm system control and protect the Dosis neighborhood from potential emergencies.\nThe above text is copied from the welcome screen for this terminal (below). As we can see for this terminal there aren‚Äôt that many tips or hints available. So I instantly begun think we‚Äôre in a classical situation where we have to look deeper into the terminal to find out more.\nSince we have no information, and in such games like this, I usually list out the contents right there at the entrypoint, using command ls -la:\nNot much in this folder except a bin folder, which tells me that users command most like are meant to run from this. What better to do than to list its contents and try to uncover what lives in this folder?\nSo, I am not allowed to run that runtoanswer binary? So - yes, that would be my goal here. To find a way to execute it. Tradiotionally on other CTF platform like TryHackMe and Hack The Box we usually list out what sudo permissions this user has (sudo -l to rescue):\nOkay, this user has the rights to execute a shell script using sudo. Finding out what this shell scripts does:\nHow cute. It‚Äôs a sugary wrapper around some system utilities to list out usage metrics. From the script I see it uses echo, df, free, ps, grep, and head - all without using full paths! This means I can create my own version of one of them to spawn a Bash shell and gain access as root (toot toot)! I suppose this is why that lonely bin folder even exist (for me to put my copy of a said utility in and execute).\nSo my plan is to create my own version of df in the local bin folder, then add a call to Bash into it, assign SUID and Executable flag to it. Then run that SUDO command and hope for the best:\nExuting my malicious df script and hoping for the best! And would you look at that, I got ROOT and can run that runtoanswer binary! Yay!\nKyle Parrish mission debrief Wow! Thank you so much! I didn‚Äôt realize sudo was so powerful. Especially when misconfigured. Who knew a simple privilege escalation could unlock the whole fire safety system?\nNow‚Ä¶ will you sudo make me a sandwich?",
    "description": "Objective Difficulty: 1/5\nAssist Kyle at the old data center with a fire alarm that just won‚Äôt chill.\nKyle Parrish mission statement If you spot a fire, let me know! I‚Äôm Kyle, and I‚Äôve been around the Holiday Hack Challenge scene for years as arnydo - picked up multiple Super Honorable Mentions along the way.\nWhen I‚Äôm not fighting fires or hunting vulnerabilities, you‚Äôll find me on a unicycle or juggling - I once showed up a professional clown with his own clubs!",
    "tags": [],
    "title": "Neighborhood Watch Bypass",
    "uri": "/act1/neighborhood-watch-bypass/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nChat with Yori near the apartment building about Santa‚Äôs mysterious gift tracker and unravel the holiday mystery.\nYori Kvitchko mission statement Hi! I‚Äôm Yori.\nI was Ed‚Äôs lost intern back in 2015, but I was found!\nThink you can check out this terminal for me? I need to use cURL to access the gift tracker system, but it has me stumped.\nPlease see what you can do!\nTerminal By listing the home directory we find a README.txt file:\nWelcome! Santa's gift-tracking service is missing! You need to find what port it's running on amd connect to it to make sure it is working! Available commands: - ss (to check running services and ports) - curl (to connect to services) - telnet (an alternative way to connect) - ls (to list files) - cat (to view files) - grep (to search text) - clear (to clear the screen) Good luck! Finding listening port The tracking application was originally configured to run on port 8080, but doesnt answer. Our objective now is to trace down which port it now listens to.\nss -tlnp The listeneing port in question is 12321, connecting to it:\ncurl http://localhost:12321 As the original port was a well known web-port, we‚Äôll just go ahead connecting using Curl:\nThe entire output is included below:\n{ \"status\": \"success\", \"message\": \"\\ud83c\\udf84 Ho Ho Ho! Santa Tracker Successfully Connected! \\ud83c\\udf84\", \"santa_tracking_data\": { \"timestamp\": \"2025-11-16 09:24:43\", \"location\": { \"name\": \"Evergreen Estates\", \"latitude\": 39.235029, \"longitude\": -101.829101 }, \"movement\": { \"speed\": \"847 mph\", \"altitude\": \"11938 feet\", \"heading\": \"340\\u00b0 SW\" }, \"delivery_stats\": { \"gifts_delivered\": 5859155, \"cookies_eaten\": 35606, \"milk_consumed\": \"2179 gallons\", \"last_stop\": \"Reindeer Ridge\", \"next_stop\": \"Yuletide Gardens\", \"time_to_next_stop\": \"5 minutes\" }, \"reindeer_status\": { \"rudolph_nose_brightness\": \"90%\", \"favorite_reindeer_joke\": \"What's Rudolph's favorite currency? Sleigh bells!\", \"reindeer_snack_preference\": \"starlight oats\" }, \"weather_conditions\": { \"temperature\": \"-8\\u00b0F\", \"condition\": \"Candy cane precipitation\" }, \"special_note\": \"Thanks to your help finding the correct port, the neighborhood can now track Santa's arrival! The mischievous gnomes will be caught and will be put to work wrapping presents.\" } } Yori Kvitchko mission debrief Great work - thank you!\nGeez, maybe you can be my intern now!",
    "description": "Objective Difficulty: 1/5\nChat with Yori near the apartment building about Santa‚Äôs mysterious gift tracker and unravel the holiday mystery.\nYori Kvitchko mission statement Hi! I‚Äôm Yori.\nI was Ed‚Äôs lost intern back in 2015, but I was found!\nThink you can check out this terminal for me? I need to use cURL to access the gift tracker system, but it has me stumped.",
    "tags": [],
    "title": "Santa's Gift Tracking Service Port Mystery",
    "uri": "/act1/santas-gift-tracking-service-port-mystery/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nSkate over to Jared at the frozen pond for some network magic and learn the ropes by the hockey rink.\nJared Folkins mission statement Jared Folkins here! My favorite Christmas movie is White Christmas. You should find me on the socials and tell me what yours is.\nYou know, I think Santa is right! It truly is better to give than to receive.\nI love singing Carols with my family! üéµO holy night, the stars are brightly shining‚Ä¶üéµ\nSanta‚Äôs got the right idea about giving, and I‚Äôm excited to give you a fantastic way to learn networking fundamentals!\nThis interactive visualization I‚Äôve created shows you exactly how packets travel, how protocols work, and why networks behave the way they do.\nIt‚Äôs way better than staring at boring textbooks - you can actually see what‚Äôs happening!\nWant to dive into some hands-on network exploration?\nSolution Jared Folkins mission debrief Wonderful! You‚Äôve mastered those networking basics beautifully.\nNow you can see how all the pieces of the network puzzle fit together - it‚Äôs truly better to give knowledge than to keep it to yourself!",
    "description": "Objective Difficulty: 1/5\nSkate over to Jared at the frozen pond for some network magic and learn the ropes by the hockey rink.\nJared Folkins mission statement Jared Folkins here! My favorite Christmas movie is White Christmas. You should find me on the socials and tell me what yours is.\nYou know, I think Santa is right! It truly is better to give than to receive.",
    "tags": [],
    "title": "Visual Network Thinger",
    "uri": "/act1/visual-network-thinger/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nFind Elgee in the big hotel for a firewall frolic and some techy fun.\nChris Elgee mission statement Oh hi! Am I on the road again? I should buy souvenirs for the family.\nLoud shirts? Love them. Because - hey, if you aren‚Äôt having fun, what are you even doing??\nAnd yes, finger guns are 100% appropriate for military portraits.\n‚Ä¶ We should get dessert soon!\nWelcome to my little corner of network security! finger guns\nI‚Äôve whipped up something sweeter than my favorite whoopie pie - an interactive firewall simulator that‚Äôll teach you more in ten minutes than most textbooks do in ten chapters.\nDon‚Äôt worry about breaking anything; that‚Äôs half the fun of learning!\nReady to dig in?\nHoliday Firewall Simulator Chris Elgee mission debrief",
    "description": "Objective Difficulty: 1/5\nFind Elgee in the big hotel for a firewall frolic and some techy fun.\nChris Elgee mission statement Oh hi! Am I on the road again? I should buy souvenirs for the family.\nLoud shirts? Love them. Because - hey, if you aren‚Äôt having fun, what are you even doing??\nAnd yes, finger guns are 100% appropriate for military portraits.",
    "tags": [],
    "title": "Visual Firewall Thinger",
    "uri": "/act1/visual-firewall-thinger/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nMeet Eric in the hotel parking lot for Nmap know-how and scanning secrets. Help him connect to the wardriving rig on his motorcycle!\nEric Pursley mission statement Hey, I‚Äôm Eric. As you can see, I‚Äôm an avid motorcyclist. And I love traveling the world with my wife.\nI enjoy being creative and making things. For example, a cybersecurity tool called Zero-E that I‚Äôm quite proud of, and the Baldur‚Äôs Gate 3 mod called Manaflare. I‚Äôm even in the BG3 credits!\nI also make tools, ranges, and HHC worlds for Counter Hack. Yup, including the one you‚Äôre in right now.\nBut most of the time, I‚Äôm helping organizations in the real world be more secure. I do a bunch of different kinds of pentesting, but speciailize in network and physical.\nSome advice: stay laser-focused on your goals and don‚Äôt let the distractions life throws at you lead you astray. That‚Äôs how I ended up at Counter Hack!\nSpeaking of tools, let me introduce you to one of the most essential weapons in any pentester‚Äôs arsenal: Nmap.\nIt‚Äôs like having X-ray vision for networks, and I‚Äôve set up a perfect environment for you to learn the fundamentals.\nHelp me find and connect to the wardriving rig‚Äôs service on my motorcycle!\nIntro top Nmap terminal This terminal starts with a simple welcome screen:\nTask 1 - scan top 1000 ports When run without any options, nmap performs a TCP port scan of the top 1000 ports. Run a default scan of 127.0.12.25 and see which port is open.\nFor this we use just use the following command:\nnmap 127.0.12.25 Task 1 screen: Task 1 results: The scan revealed that port TCP/8080 is open.\nTask 2 - Scan all ports Sometimes the top 1000 ports are not enough. Run an nmap scan of all TCP ports on 127.0.12.25 and see which port is open.\nIf we use the ports switch for namep, -p, and add a -, we instruct Nmap to scan all ports. The command will then be:\nnmap -p- 127.0.12.25 Scan results: Task 3 - Scan a range Nmap can also scan a range of IP addresses- Scan the range 127.0.12.20 - 127.0.12.28 and see which has a port open.\nTo scan a range we can define a range like so, using the scan all ports option in addition:\nnmap -p- 127.0.12-20-28 Scan results: Task 4 - Version scanning Namp has a version detection engine, to help determine waht services are running on a given port. What services is running on 127.0.12.25?\nThe service version scan option is called -sV, we can use it like so:\nnmap -p 8080 -sV 127.0.12.25 Results version scanning: Task 5 - interacting with a port Sometimes you want to interact with a port. which is a perfect job for Netcat! Use the ncat tool to connect to TCP port 240601 on 127.0.12.25 and view the banner returned\nNcat is a common tool we often use in pentests and threat hunting. Its standard use follows this format nc \u003cip\u003e \u003cport\u003e, it defaults to use TCP. We use the following command:\nnc 127.0.12.25 24601 Eric Pursley mission debrief Excellent work! You‚Äôve got the Nmap fundamentals down - that X-ray vision is going to serve you well in future challenges.\nNow you‚Äôre ready to scan networks like a seasoned pentester!",
    "description": "Objective Difficulty: 1/5\nMeet Eric in the hotel parking lot for Nmap know-how and scanning secrets. Help him connect to the wardriving rig on his motorcycle!\nEric Pursley mission statement Hey, I‚Äôm Eric. As you can see, I‚Äôm an avid motorcyclist. And I love traveling the world with my wife.\nI enjoy being creative and making things. For example, a cybersecurity tool called Zero-E that I‚Äôm quite proud of, and the Baldur‚Äôs Gate 3 mod called Manaflare. I‚Äôm even in the BG3 credits!",
    "tags": [],
    "title": "Intro to Nmap",
    "uri": "/act1/intro-to-nmap/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nHelp the Goose Grace near the pond find which Azure Storage account has been misconfigured to allow public blob access by analyzing the export file.\nGoose Grace mission statement HONK!!! HONK!!!!\nThe Neighborhood HOA uses Azure storage accounts for various IT operations.\nYou‚Äôve been asked to audit their storage security configuration to ensure no sensitive data is publicly accessible.\nRecent security reports suggest some storage accounts might have public blob access enabled, creating potential data exposure risks.\nBlob Challenge Terminal Getting help Prototype command:\naz help | less And we got help:\nListing accounts Prototype command:\naz account show | less Listing Azure storage accounts Prototype command:\naz storage account list | less The output is shown here in is full glory:\n[ { \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/theneighborhood-rg1/providers/Microsoft.Storage/storageAccounts/neighborhood1\", \"kind\": \"StorageV2\", \"location\": \"eastus\", \"name\": \"neighborhood1\", \"properties\": { \"accessTier\": \"Hot\", \"allowBlobPublicAccess\": false, \"encryption\": { \"keySource\": \"Microsoft.Storage\", \"services\": { \"blob\": { \"enabled\": true } } }, \"minimumTlsVersion\": \"TLS1_2\" }, \"resourceGroup\": \"theneighborhood-rg1\", \"sku\": { \"name\": \"Standard_LRS\" }, \"tags\": { \"env\": \"dev\" } }, { \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/theneighborhood-rg1/providers/Microsoft.Storage/storageAccounts/neighborhood2\", \"kind\": \"StorageV2\", \"location\": \"eastus2\", \"name\": \"neighborhood2\", \"properties\": { \"accessTier\": \"Cool\", \"allowBlobPublicAccess\": true, \"encryption\": { \"keySource\": \"Microsoft.Storage\", \"services\": { \"blob\": { \"enabled\": false } } }, \"minimumTlsVersion\": \"TLS1_0\" }, \"resourceGroup\": \"theneighborhood-rg1\", \"sku\": { \"name\": \"Standard_GRS\" }, \"tags\": { \"owner\": \"Admin\" } }, { \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/theneighborhood-rg2/providers/Microsoft. Storage/storageAccounts/neighborhood3\", \"kind\": \"BlobStorage\", \"location\": \"westus\", \"name\": \"neighborhood3\", \"properties\": { \"accessTier\": \"Hot\", \"allowBlobPublicAccess\": false, \"encryption\": { \"keySource\": \"Microsoft.Keyvault\", \"services\": { \"blob\": { \"enabled\": true } } }, \"minimumTlsVersion\": \"TLS1_2\" }, \"resourceGroup\": \"theneighborhood-rg2\", \"sku\": { \"name\": \"Standard_RAGRS\" }, \"tags\": { \"department\": \"NeighborhoodWatch\" } }, { \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/theneighborhood-rg2/providers/Microsoft. Storage/storageAccounts/neighborhood4\", \"kind\": \"StorageV2\", \"location\": \"westus2\", \"name\": \"neighborhood4\", \"properties\": { \"accessTier\": \"Hot\", \"allowBlobPublicAccess\": false, \"minimumTlsVersion\": \"TLS1_2\", \"networkAcls\": { \"bypass\": \"AzureServices\", \"virtualNetworkRules\": [] } }, \"resourceGroup\": \"theneighborhood-rg2\", \"sku\": { \"name\": \"Premium_LRS\" }, \"tags\": { \"critical\": \"true\" } }, { \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/theneighborhood-rg1/providers/Microsoft. Storage/storageAccounts/neighborhood5\", \"kind\": \"StorageV2\", \"location\": \"eastus\", \"name\": \"neighborhood5\", \"properties\": { \"accessTier\": \"Cool\", \"allowBlobPublicAccess\": false, \"isHnsEnabled\": true, \"minimumTlsVersion\": \"TLS1_2\" }, \"resourceGroup\": \"theneighborhood-rg1\", \"sku\": { \"name\": \"Standard_LRS\" }, \"tags\": { \"project\": \"Homes\" } }, { \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/theneighborhood-rg2/providers/Microsoft. Storage/storageAccounts/neighborhood6\", \"kind\": \"StorageV2\", \"location\": \"centralus\", \"name\": \"neighborhood6\", \"properties\": { \"accessTier\": \"Hot\", \"allowBlobPublicAccess\": false, \"minimumTlsVersion\": \"TLS1_2\", \"tags\": { \"replicate\": \"true\" } }, \"resourceGroup\": \"theneighborhood-rg2\", \"sku\": { \"name\": \"Standard_ZRS\" }, \"tags\": {} } ] Showing accounts with a common misconfiguration At the very start we are given a hint that one of the accounts looks suspicious. We also get a prototype command:\naz storage account show --name xxxxxxxxxx | less From the JSON configuration (posted above), we see accounts named neighboorhood1 through neighborhood6. By looking at the configuration we see that account neighboorhood2 appears to be much suspicious based on these findings:\nFinding A. Public blob access enabled\n\"allowBlobPublicAccess\": true This means that anyone on the internet may access blob data if the container is configured as public. Attackers routinely scan Azure blobs for exposed data (exactly like S3 bucket scanning).\nFinding B. At-rest encryption disabled\n\"blob\": { \"enabled\": false } Azure nowadays forces encryption regardless, but this config still signals mismanagement. In older accounts or older tooling, this could mean plaintext at rest.\nFinding C. TLS 1.0\n\"minimumTlsVersion\": \"TLS1_0\" TLS1.0 is deprecated and vulnerable to known protocol-level weaknesses.\nFinding D. Combined impact\nIf any container inside this account is set to public, attackers can enumerate and download everything silently:\nPublic website files Uploaded backups Customer data Credentials accidentally uploaded Logs containing secrets Public misconfigured blob containers are one of the top Azure data leak causes.\nWe can thus use this command directly to view more information about neighborhood2 account:\naz storage account show --name neighborhood2 | less Listing containers Other than stating we need to list containers in neighboorhood2, and a resource URL, no other hints or prototype commands are given. However, I have already solved the ‚ÄúSpare Key‚Äù objective - I‚Äôll just reuse the concept from that objective here:\naz storage container list --account-name neighborhood2 Listing blobs Same procedure as for listing the containers, reuse the concept in ‚ÄúSpare Key‚Äù:\naz storage blob list --container-name 'private' --account-name neighborhood2 --auth-mode login az storage blob list --container-name 'public' --account-name neighborhood2 --auth-mode login Downloading admin_credentials.txt We are now to try downloading and viewing the blob file named admin_credentials.txt from the public container. Still, reusing the concept from ‚ÄúSpare Key‚Äù:\naz storage blob download --container-name 'public' --account-name neighborhood2 --auth-mode login --name 'admin_credentials.txt' --file /dev/stdout | less The entire admin_credentials.txt file is listed below:\n# You have discovered an Azure Storage account with \"allowBlobPublicAccess\": true. # This misconfiguration allows ANYONE on the internet to view and download files # from the blob container without authentication. # Public blob access is highly insecure when sensitive data (like admin credentials) # is stored in these containers. Always disable public access unless absolutely required. Azure Portal Credentials User: azureadmin Pass: AzUR3!P@ssw0rd#2025 Windows Server Credentials User: administrator Pass: W1nD0ws$Srv!@42 SQL Server Credentials User: sa Pass: SqL!P@55#2025$ Active Directory Domain Admin User: corp\\administrator Pass: D0m@in#Adm!n$765 Exchange Admin Credentials User: exchangeadmin Pass: Exch@ng3!M@il#432 VMware vSphere Credentials User: vsphereadmin Pass: VMW@r3#Clu$ter!99 Network Switch Credentials User: netadmin Pass: N3t!Sw!tch$C0nfig# Firewall Admin Credentials User: fwadmin Pass: F1r3W@ll#S3cur3!77 Backup Server Credentials User: backupadmin Pass: B@ckUp!Srv#2025$ Monitoring System Admin User: monitoradmin Pass: M0n!t0r#Sys$P@ss! SharePoint Admin Credentials User: spadmin Pass: Sh@r3P0!nt#Adm!n2025 Git Server Admin User: gitadmin Pass: G1t#Srv!Rep0$C0de Goose Grace mission debrief HONK HONK HONK! ‚ÄòNo sensitive data publicly accessible‚Äô they claimed. Meanwhile, literally everything was public! Good save, security expert!",
    "description": "Objective Difficulty: 1/5\nHelp the Goose Grace near the pond find which Azure Storage account has been misconfigured to allow public blob access by analyzing the export file.\nGoose Grace mission statement HONK!!! HONK!!!!\nThe Neighborhood HOA uses Azure storage accounts for various IT operations.\nYou‚Äôve been asked to audit their storage security configuration to ensure no sensitive data is publicly accessible.",
    "tags": [],
    "title": "Blob Storage Challenge in the Neighborhood",
    "uri": "/act1/blob-storage-challenge-in-the-neighborhood/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nHelp Goose Barry near the pond identify which identity has been granted excessive Owner permissions at the subscription level, violating the principle of least privilege.\nGoose Barry mission statement You want me to say what exactly? Do I really look like someone who says MOOO?\nThe Neighborhood HOA hosts a static website on Azure Storage.\nAn admin accidentally uploaded an infrastructure config file that contains a long-lived SAS token.\nUse Azure CLI to find the leak and report exactly where it lives.\nSpare Key Terminal Listing all resource groups Prototype command:\naz group list -o table Finding storage accounts Prototype command:\naz storage account list --resource-group rg-the-neighborhood -o table Finding a website Prototype command:\naz storage blob service-properties show --account-name \u003cinsert_account_name\u003e --auth-mode login There is a website in storage account neighboorhoodhoa\nneighbor@d224308072dc:~$ az storage blob service-properties show --account-name neighborhoodhoa --auth-mode login { \"enabled\": true, \"errorDocument404Path\": \"404.html\", \"indexDocument\": \"index.html\" } Finding containers Prototype command:\naz storage container list This command isn‚Äôt enough and we have to extend it arguments. Luckily, we can just look at the previous command and add the arguments --account-name and --auth-mode - like so:\naz storage container list --account-name neighborhoodhoa --auth-mode login Examining files in static website container In this excersice we are not given a prototype command, however we are provided with the following hint:\nwhen using --container-name you might need '\u003cname\u003e' However, by applying some forward thinking we can easily whip up a command following the query language logic - like so:\naz storage blob list --container-name '$web' --account-name neighborhoodhoa --auth-mode login Looking at files Yet again we are not presented with a prototype command, but rather with a hint:\nhint: --file /dev/stdout | less will print to your terminal By applying the same logic as previous and consulting ChatGPT, I ended up with this command to list a file:\naz storage blob download --container-name '$web' --account-name neighborhoodhoa --auth-modelo gin --name 'iac/terraform.tfvars' --file /dev/stdout | less The content of the file is:\n# Terraform Variables for HOA Website Deployment # Application: Neighborhood HOA Service Request Portal # Environment: Production # Last Updated: 2025-09-20 # DO NOT COMMIT TO PUBLIC REPOS # === Application Configuration === app_name = \"hoa-service-portal\" app_version = \"2.1.4\" environment = \"production\" # === Database Configuration === database_server = \"sql-neighborhoodhoa.database.windows.net\" database_name = \"hoa_requests\" database_username = \"hoa_app_user\" # Using Key Vault reference for security database_password_vault_ref = \"@Microsoft.KeyVault(SecretUri=https://kv-neighborhoodhoa-prod.vault.azure.net/secrets/db-password/)\" # === Storage Configuration for File Uploads === storage_account = \"neighborhoodhoa\" uploads_container = \"resident-uploads\" documents_container = \"hoa-documents\" # TEMPORARY: Direct storage access for migration script # WARNING: Remove after data migration to new storage account # This SAS token provides full access - HIGHLY SENSITIVE! migration_sas_token = \"sv=2023-11-03\u0026ss=b\u0026srt=co\u0026sp=rlacwdx\u0026se=2100-01-01T00:00:00Z\u0026spr=https\u0026sig=1djO1Q%2Bv0wIh7mYi3n%2F7r1d%2F9u9H%2F5%2BQxw8o2i9QMQc%3D\" # === Email Service Configuration === # Using Key Vault for sensitive email credentials sendgrid_api_key_vault_ref = \"@Microsoft.KeyVault(SecretUri=https://kv-neighborhoodhoa-prod.vault.azure.net/secrets/sendgrid-key/)\" from_email = \"noreply@theneighborhood.com\" admin_email = \"admin@theneighborhood.com\" # === Application Settings === session_timeout_minutes = 60 max_file_upload_mb = 10 allowed_file_types = [\"pdf\", \"jpg\", \"jpeg\", \"png\", \"doc\", \"docx\"] # === Feature Flags === enable_online_payments = true enable_maintenance_requests = true enable_document_portal = false enable_resident_directory = true # === API Keys (Key Vault References) === maps_api_key_vault_ref = \"@Microsoft.KeyVault(SecretUri=https://kv-neighborhoodhoa-prod.vault.azure.net/secrets/maps-api-key/)\" weather_api_key_vault_ref = \"@Microsoft.KeyVault(SecretUri=https://kv-neighborhoodhoa-prod.vault.azure.net/secrets/wea ther-api-key/)\" # === Notification Settings (Key Vault References) === sms_service_vault_ref = \"@Microsoft.KeyVault(SecretUri=https://kv-neighborhoodhoa-prod.vault.azure.net/secrets/sms-cre dentials/)\" notification_webhook_vault_ref = \"@Microsoft.KeyVault(SecretUri=https://kv-neighborhoodhoa-prod.vault.azure.net/secret s/slack-webhook/)\" # === Deployment Configuration === deploy_static_files_to_cdn = true cdn_profile = \"hoa-cdn-prod\" cache_duration_hours = 24 # Backup schedule backup_frequency = \"daily\" backup_retention_days = 30 { \"downloaded\": true, \"file\": \"/dev/stdout\" } Goose Barry mission debrief There it is. A SAS token with read-write-delete permissions, publicly accessible. At least someone around here knows how to do a proper security audit.",
    "description": "Objective Difficulty: 1/5\nHelp Goose Barry near the pond identify which identity has been granted excessive Owner permissions at the subscription level, violating the principle of least privilege.\nGoose Barry mission statement You want me to say what exactly? Do I really look like someone who says MOOO?\nThe Neighborhood HOA hosts a static website on Azure Storage.\nAn admin accidentally uploaded an infrastructure config file that contains a long-lived SAS token.",
    "tags": [],
    "title": "Spare Key",
    "uri": "/act1/spare-key/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "",
    "description": "",
    "tags": [],
    "title": "The Open Door",
    "uri": "/act1/the-open-door/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nHelp Goose James near the park discover the accidentally leaked SAS token in a public JavaScript file and determine what Azure Storage resource it exposes and what permissions it grants.\nGoose James mission statement CLUCK CLU‚Ä¶ I think I might be losing my mind. All the elves are gone and I‚Äôm still hearing voices.\nThe Neighborhood HOA uses Azure for their IT infrastructure.\nThe Neighborhood network admins use RBAC fo access control.\nYour task is to audit their RBAC configuration to ensure they‚Äôre following security best practices.\nThey claim all elevated access uses PIM, but you need to verify there are no permanently assigned Owner roles.\nTerminal Query parameter Prototype command:\naz account list --query \"[].name\" Conditional filtering Prototype command:\naz account list --query \"[?state=='Enabled'].{Name:name, ID:id}\" Looking at owner of first listed subscription Prototype command:\naz role assignment list --scope \"/subscriptions/{ID of first Subscription}\" --query [?roleDefinition=='Owner'] Updated command:\naz role assignment list --scope \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64\" --query [?roleDefinition=='Owner'] Looking at other owners listed subscriptions Let‚Äôs run the previous command against the other subscriptions to see what we come up with:\naz role assignment list --scope \"/subscriptions/4d9dbf2a-90b4-4d40-a97f-dc51f3c3d46e\" --query [?roleDefinition=='Owner'] az role assignment list --scope \"/subscriptions/065cc24a-077e-40b9-b666-2f4dd9f3a617\" --query [?roleDefinition=='Owner'] az role assignment list --scope \"/subscriptions/681c0111-ca84-47b2-808d-d8be2325b380\" --query [?roleDefinition=='Owner'] Subscription 065cc24a-077e-40b9-b666-2f4dd9f3a617 yielded something interesting:\n[ { \"condition\": \"null\", \"conditionVersion\": \"null\", \"createdBy\": \"85b095fa-a9b4-4bdc-a3af-c9f95ebb8dd6\", \"createdOn\": \"2025-09-10T15:45:12.439266+00:00\", \"delegatedManagedIdentityResourceId\": \"null\", \"description\": \"null\", \"id\": \"/subscriptions/065cc24a-077e-40b9-b666-2f4dd9f3a617/providers/Microsoft.Authorization/roleAssignments/b1c69caa-a4d6-449a-a090-efacb23b55f3\", \"name\": \"b1c69caa-a4d6-449a-a090-efacb23b55f3\", \"principalId\": \"2b5c7aed-2728-4e63-b657-98f759cc0936\", \"principalName\": \"PIM-Owners\", \"principalType\": \"Group\", \"roleDefinitionId\": \"/subscriptions/065cc24a-077e-40b9-b666-2f4dd9f3a617/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\", \"roleDefinitionName\": \"Owner\", \"scope\": \"/subscriptions/065cc24a-077e-40b9-b666-2f4dd9f3a617\", \"type\": \"Microsoft.Authorization/roleAssignments\", \"updatedBy\": \"85b095fa-a9b4-4bdc-a3af-c9f95ebb8dd6\", \"updatedOn\": \"2025-09-10T15:45:12.439266+00:00\" }, { \"condition\": \"null\", \"conditionVersion\": \"null\", \"createdBy\": \"85b095fa-a9b4-4bdc-a3af-c9f95ebb8dd6\", \"createdOn\": \"2025-09-10T16:58:16.317381+00:00\", \"delegatedManagedIdentityResourceId\": \"null\", \"description\": \"null\", \"id\": \"/subscriptions/065cc24a-077e-40b9-b666-2f4dd9f3a617/providers/Microsoft.Authorization/roleAssignments/6b452f58-6872-4064-ae9b-78742e8d987e\", \"name\": \"6b452f58-6872-4064-ae9b-78742e8d987e\", \"principalId\": \"6b982f2f-78a0-44a8-b915-79240b2b4796\", \"principalName\": \"IT Admins\", \"principalType\": \"Group\", \"roleDefinitionId\": \"/subscriptions/065cc24a-077e-40b9-b666-2f4dd9f3a617/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\", \"roleDefinitionName\": \"Owner\", \"roleDefinitionName\": \"Owner\", \"scope\": \"/subscriptions/065cc24a-077e-40b9-b666-2f4dd9f3a617\", \"type\": \"Microsoft.Authorization/roleAssignments\", \"updatedBy\": \"85b095fa-a9b4-4bdc-a3af-c9f95ebb8dd6\", \"updatedOn\": \"2025-09-10T16:58:16.317381+00:00\" } ] What is interesting here?\nGroup PIM-Owners (principalId: 2b5c7aed-2728-4e63-b657-98f759cc0936) has permanent Owner on the full subscription ‚Äî weak PIM/JIT hygiene. Group IT Admins (principalId: 6b982f2f-78a0-44a8-b915-79240b2b4796) is also assigned Owner ‚Äî likely over-privileged for a broad admin group. Both assignments are unrestricted ‚Äî no conditions, no constraints, full subscription-level control. Both assignments were created by the same identity (createdBy: 85b095fa-a9b4-4bdc-a3af-c9f95ebb8dd6) Figuring out membership of group Prototype command:\naz ad member list Refined command aiming directly at ‚ÄúIT Admins‚Äù as that looked most promising:\naz ad member list --group 6b982f2f-78a0-44a8-b915-79240b2b4796 | less Turns out we found a nested group\nNested groups Rerunning the last command, but with a different id:\naz ad member list --group 631ebd3f-39f9-4492-a780-aef2aec8c94e | less Full output provided below:\n[ { \"@odata.type\": \"#microsoft.graph.user\", \"businessPhones\": [ \"+1-555-0199\" ], \"displayName\": \"Firewall Frank\", \"givenName\": \"Frank\", \"id\": \"b8613dd2-5e33-4d77-91fb-b4f2338c19c9\", \"jobTitle\": \"HOA IT Administrator\", \"mail\": \"frank.firewall@theneighborhood.invalid\", \"mobilePhone\": \"+1-555-0198\", \"officeLocation\": \"HOA Community Center - IT Office\", \"preferredLanguage\": \"en-US\", \"surname\": \"Firewall\", \"userPrincipalName\": \"frank.firewall@theneighborhood.onmicrosoft.com\" } ] Goose James mission debrief You found the permanent assignments! CLUCK! See, I‚Äôm not crazy - the security really WAS misconfigured. Now maybe I can finally get some peace and quiet‚Ä¶",
    "description": "Objective Difficulty: 1/5\nHelp Goose James near the park discover the accidentally leaked SAS token in a public JavaScript file and determine what Azure Storage resource it exposes and what permissions it grants.\nGoose James mission statement CLUCK CLU‚Ä¶ I think I might be losing my mind. All the elves are gone and I‚Äôm still hearing voices.\nThe Neighborhood HOA uses Azure for their IT infrastructure.",
    "tags": [],
    "title": "Owner",
    "uri": "/act1/owner/index.html"
  },
  {
    "breadcrumb": "",
    "content": "Way back in 2015, the mysterious Atnas Corporation almost ruined the entire holiday season through their nefarious Gnome In Your Home plot. Their villainy centered upon convincing parents to purchase little Gnome dolls that played joyful holiday songs to their children. With Gnome sales topping two million units, a blitz of Atnas Corp advertisements encouraged parents to move their Gnomes around the house daily so that their children could hunt for them in a fun little game. Little did parents know that these Gnomes were snooping IoT devices with a camera and wireless internet access, furtively sending photos to burglars who would rob their houses of their treasures en masse on Christmas Eve, 2015. The incredible efforts of SANS Holiday Hack investigators around the world foiled the foul plot, exposing the criminal mastermind behind Atlas Corp: Cindy Lou Who, age 62.\nBut those old Gnomes didn‚Äôt disappear. They lay discarded, gathering dust on shelves, in attics, and among other forgotten places throughout the world. Until now. There must have been some magic in those Gnomes, because, due to some unseen spark, some haunting hocus pocus, the Gnomes have quickened and are now walking among us! We now return with the Counter Hack Crew to the Duke Dosis neighborhood as the Holiday Season 2025 unfolds.",
    "description": "Way back in 2015, the mysterious Atnas Corporation almost ruined the entire holiday season through their nefarious Gnome In Your Home plot. Their villainy centered upon convincing parents to purchase little Gnome dolls that played joyful holiday songs to their children. With Gnome sales topping two million units, a blitz of Atnas Corp advertisements encouraged parents to move their Gnomes around the house daily so that their children could hunt for them in a fun little game. Little did parents know that these Gnomes were snooping IoT devices with a camera and wireless internet access, furtively sending photos to burglars who would rob their houses of their treasures en masse on Christmas Eve, 2015. The incredible efforts of SANS Holiday Hack investigators around the world foiled the foul plot, exposing the criminal mastermind behind Atlas Corp: Cindy Lou Who, age 62.",
    "tags": [],
    "title": "Intro",
    "uri": "/index.html"
  },
  {
    "breadcrumb": "Intro",
    "content": "",
    "description": "",
    "tags": [],
    "title": "Categories",
    "uri": "/categories/index.html"
  },
  {
    "breadcrumb": "Intro",
    "content": "",
    "description": "",
    "tags": [],
    "title": "Tags",
    "uri": "/tags/index.html"
  }
]
