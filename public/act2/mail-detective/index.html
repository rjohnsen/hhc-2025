<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="html">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.152.2">
    <meta name="generator" content="Relearn 8.2.0+926ba4d1230e27319cf62da0633eb3420e6af1bf">
    <meta name="description" content="Objective Difficulty: 2/5
Help Mo in City Hall solve a curly email caper and crack the IMAP case. What is the URL of the pastebin service the gnomes are using?
Maurice Wilson mission statement Hey there! I‚Äôm Mo, on loan from the Air Force, and let me tell you - Counter Hack is the best job I have ever had!
There is something in the works. Come see me later and we will talk. Can‚Äôt say much right now, but check back later. You might be interested.">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Mail Detective :: SANS Holiday Hack Challenge 2025">
    <meta name="twitter:description" content="Objective Difficulty: 2/5
Help Mo in City Hall solve a curly email caper and crack the IMAP case. What is the URL of the pastebin service the gnomes are using?
Maurice Wilson mission statement Hey there! I‚Äôm Mo, on loan from the Air Force, and let me tell you - Counter Hack is the best job I have ever had!
There is something in the works. Come see me later and we will talk. Can‚Äôt say much right now, but check back later. You might be interested.">
    <meta property="og:url" content="http://localhost:1313/act2/mail-detective/index.html">
    <meta property="og:site_name" content="SANS Holiday Hack Challenge 2025">
    <meta property="og:title" content="Mail Detective :: SANS Holiday Hack Challenge 2025">
    <meta property="og:description" content="Objective Difficulty: 2/5
Help Mo in City Hall solve a curly email caper and crack the IMAP case. What is the URL of the pastebin service the gnomes are using?
Maurice Wilson mission statement Hey there! I‚Äôm Mo, on loan from the Air Force, and let me tell you - Counter Hack is the best job I have ever had!
There is something in the works. Come see me later and we will talk. Can‚Äôt say much right now, but check back later. You might be interested.">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="website">
    <meta itemprop="name" content="Mail Detective :: SANS Holiday Hack Challenge 2025">
    <meta itemprop="description" content="Objective Difficulty: 2/5
Help Mo in City Hall solve a curly email caper and crack the IMAP case. What is the URL of the pastebin service the gnomes are using?
Maurice Wilson mission statement Hey there! I‚Äôm Mo, on loan from the Air Force, and let me tell you - Counter Hack is the best job I have ever had!
There is something in the works. Come see me later and we will talk. Can‚Äôt say much right now, but check back later. You might be interested.">
    <meta itemprop="datePublished" content="2025-11-23T13:42:34+01:00">
    <meta itemprop="dateModified" content="2025-11-23T13:42:34+01:00">
    <meta itemprop="wordCount" content="799">
    <title>Mail Detective :: SANS Holiday Hack Challenge 2025</title>
    <link href="/act2/mail-detective/index.xml" rel="alternate" type="application/rss+xml" title="Mail Detective :: SANS Holiday Hack Challenge 2025">
    <link href="/css/auto-complete/auto-complete.min.css?1764499442" rel="stylesheet">
    <script src="/js/auto-complete/auto-complete.min.js?1764499442" defer></script>
    <script src="/js/search-lunr.js?1764499442" defer></script>
    <script src="/js/search.js?1764499442" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="/searchindex.en.js?1764499442";
    </script>
    <script src="/js/lunr/lunr.min.js?1764499442" defer></script>
    <script src="/js/lunr/lunr.stemmer.support.min.js?1764499442" defer></script>
    <script src="/js/lunr/lunr.multi.min.js?1764499442" defer></script>
    <script src="/js/lunr/lunr.en.min.js?1764499442" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['en'];
    </script>
    <link href="/fonts/fontawesome/css/fontawesome-all.min.css?1764499442" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/fonts/fontawesome/css/fontawesome-all.min.css?1764499442" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar/perfect-scrollbar.min.css?1764499442" rel="stylesheet">
    <link href="/css/theme.css?1764499442" rel="stylesheet">
    <link href="/css/format-html.css?1764499442" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = ``;
      window.relearn.path='\/act2\/mail-detective\/index.html';
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..';
      window.relearn.absBaseUri='http:\/\/localhost:1313';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.relearn.disableInlineCopyToClipboard=false;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      // variant stuff
      window.relearn.themevariants = [ 'hhc-2025' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script>
  </head>
  <body class="mobile-support html" data-url="/act2/mail-detective/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide">
<span class="btn cstyle link noborder notitle interactive"><button onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button></span>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><button onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button></span>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li><a href="#objective">Objective</a></li>
    <li><a href="#maurice-wilson-mission-statement">Maurice Wilson mission statement</a></li>
    <li><a href="#mail-detective-curly-imap-investigation">Mail Detective: Curly IMAP Investigation</a></li>
    <li><a href="#maurice-wilson-mission-debrief">Maurice Wilson mission debrief</a></li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/index.html"><span itemprop="name">Intro</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/act2/index.html"><span itemprop="name">Act 2</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><span itemprop="name">Mail Detective</span><meta itemprop="position" content="3"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><a href="/act2/retro-recovery/index.html" title="Retro Recovery (ü°ê)"><i class="fa-fw fas fa-chevron-left"></i></a></span>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><a href="/act2/idorable-bistro/index.html" title="Idorable Bistro (ü°í)"><i class="fa-fw fas fa-chevron-right"></i></a></span>
            </div>
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><button onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button></span>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable act2" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="mail-detective">Mail Detective</h1>

<p><a href="#R-image-bb3163f3b6ca5c581afc5c1719f3ff41" class="lightbox-link"><img alt="Maurice Wilson" class="lazy lightbox figure-image" loading="lazy" src="/images/act2/mauricewilson-avatar.gif" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-bb3163f3b6ca5c581afc5c1719f3ff41"><img alt="Maurice Wilson" class="lazy lightbox lightbox-image" loading="lazy" src="/images/act2/mauricewilson-avatar.gif"></a></p>
<h2 id="objective">Objective</h2>
<p>Difficulty: 2/5</p>
<p>Help Mo in City Hall solve a curly email caper and crack the IMAP case. What is the URL of the pastebin service the gnomes are using?</p>
<h2 id="maurice-wilson-mission-statement">Maurice Wilson mission statement</h2>
<blockquote>
<p>Hey there! I&rsquo;m Mo, on loan from the Air Force, and let me tell you - Counter Hack is the best job I have ever had!</p>
<p>There is something in the works. Come see me later and we will talk. Can&rsquo;t say much right now, but check back later. You might be interested.</p>
<p>So here&rsquo;s our situation: those gnomes have been sending JavaScript-enabled emails to everyone in the neighborhood, and it&rsquo;s causing chaos.</p>
<p>We had to shut down all the email clients because they weren&rsquo;t blocking the malicious scripts - kind of like how we&rsquo;d ground aircraft until we clear a security threat.</p>
<p>The only safe way to access the email server now is through curl - yes, the HTTP tool!</p>
<p>Think you can help me use curl to connect to the IMAP server and hunt down one of these gnome emails?</p>
</blockquote>
<h2 id="mail-detective-curly-imap-investigation">Mail Detective: Curly IMAP Investigation</h2>
<p><a href="#R-image-386fdf8c8932311878560e0386e06daf" class="lightbox-link"><img alt="Welcome screen" class="lazy lightbox figure-image" loading="lazy" src="/images/act2/act2-mail-detective-1.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-386fdf8c8932311878560e0386e06daf"><img alt="Welcome screen" class="lazy lightbox lightbox-image" loading="lazy" src="/images/act2/act2-mail-detective-1.png"></a></p>
<p>To solve this objective, we must use <code>curl</code> as a lightweight IMAP client. Because curl supports IMAP natively, we can authenticate and talk directly to the mail server. The first step is to list the available mailboxes:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl <span style="color:#e6db74">&#34;imap://localhost:143/&#34;</span> -u <span style="color:#e6db74">&#34;dosismail:holidaymagic&#34;</span></span></span></code></pre></div>
<p>With no mailbox or message specified, curl sends an IMAP <code>LIST</code> command. This asks the server to return all mailboxes accessible to the user. The response looks like:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>* LIST <span style="color:#f92672">(</span><span style="color:#ae81ff">\H</span>asNoChildren<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;.&#34;</span> Spam
</span></span><span style="display:flex;"><span>* LIST <span style="color:#f92672">(</span><span style="color:#ae81ff">\H</span>asNoChildren<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;.&#34;</span> Sent
</span></span><span style="display:flex;"><span>* LIST <span style="color:#f92672">(</span><span style="color:#ae81ff">\H</span>asNoChildren<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;.&#34;</span> Archives
</span></span><span style="display:flex;"><span>* LIST <span style="color:#f92672">(</span><span style="color:#ae81ff">\H</span>asNoChildren<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;.&#34;</span> Drafts
</span></span><span style="display:flex;"><span>* LIST <span style="color:#f92672">(</span><span style="color:#ae81ff">\H</span>asNoChildren<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;.&#34;</span> INBOX</span></span></code></pre></div>
<p>Each line describes a single mailbox. The IMAP attribute <code>\HasNoChildren</code> indicates that the folder has no subfolders, <code>&quot;.&quot;</code> is the server‚Äôs hierarchy delimiter, and the final token is the mailbox name. This confirms that authentication succeeded and shows which folders we can query.</p>
<p>With the mailbox names in hand, we can start retrieving individual messages by their IMAP UID. For example:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl <span style="color:#e6db74">&#34;imap://localhost:143/INBOX;UID=1&#34;</span> -u <span style="color:#e6db74">&#34;dosismail:holidaymagic&#34;</span></span></span></code></pre></div>
<p>fetches the message with UID 1 from <code>INBOX</code>. I iterated through all messages in <code>INBOX</code> but found nothing useful. I then repeated the process for the other folders. It wasn‚Äôt until I inspected the <code>Spam</code> folder that I found something interesting:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl <span style="color:#e6db74">&#34;imap://localhost:143/Spam;UID=2&#34;</span> -u <span style="color:#e6db74">&#34;dosismail:holidaymagic&#34;</span></span></span></code></pre></div>
<p>The second message in the <code>Spam</code> folder contained the email I was looking for:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>Return-Path: &lt;<span style="color:#f92672">frozen.network</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">mysterymastermind</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">mail</span>&gt;
</span></span><span style="display:flex;"><span>Delivered-To: dosis.residents@dosisneighborhood.mail
</span></span><span style="display:flex;"><span>Received: from frost-command.mysterymastermind.mail (frost-command [10.0.0.15])
</span></span><span style="display:flex;"><span>        by mail.dosisneighborhood.mail (Postfix) with ESMTP id GHI789
</span></span><span style="display:flex;"><span>        for &lt;<span style="color:#f92672">dosis.residents</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">dosisneighborhood</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">mail</span>&gt;; Mon, 16 Sep 2025 12:10:00 +0000 (UTC)
</span></span><span style="display:flex;"><span>From: &#34;Frozen Network Bot&#34; &lt;<span style="color:#f92672">frozen.network</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">mysterymastermind</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">mail</span>&gt;
</span></span><span style="display:flex;"><span>To: &#34;Dosis Neighborhood Residents&#34; &lt;<span style="color:#f92672">dosis.residents</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">dosisneighborhood</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">mail</span>&gt;
</span></span><span style="display:flex;"><span>Cc: &#34;Jessica and Joshua&#34; &lt;<span style="color:#f92672">siblings</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">dosisneighborhood</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">mail</span>&gt;, &#34;CHI Team&#34; &lt;<span style="color:#f92672">chi.team</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">counterhack</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">com</span>&gt;
</span></span><span style="display:flex;"><span>Subject: Frost Protocol: Dosis Neighborhood Freezing Initiative
</span></span><span style="display:flex;"><span>Date: Mon, 16 Sep 2025 12:10:00 +0000
</span></span><span style="display:flex;"><span>Message-ID: &lt;<span style="color:#f92672">gnome-js-3</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">mysterymastermind</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">mail</span>&gt;
</span></span><span style="display:flex;"><span>MIME-Version: 1.0
</span></span><span style="display:flex;"><span>Content-Type: text/html; charset=UTF-8
</span></span><span style="display:flex;"><span>Content-Transfer-Encoding: 7bit
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">h1</span>&gt;Perpetual Winter Protocol Activated&lt;/<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">p</span>&gt;The mysterious mastermind&#39;s plan is proceeding... Dosis neighborhood will never thaw!&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">initCryptoMiner</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">worker</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">start</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Frost&#39;s crypto miner started - mining FrostCoin for perpetual winter fund&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">interval</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">setInterval</span>(<span style="color:#66d9ef">function</span>() {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Mining FrostCoin... Hash rate: &#34;</span> <span style="color:#f92672">+</span> Math.<span style="color:#a6e22e">floor</span>(Math.<span style="color:#a6e22e">random</span>() <span style="color:#f92672">*</span> <span style="color:#ae81ff">1000</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; H/s&#34;</span>);
</span></span><span style="display:flex;"><span>            }, <span style="color:#ae81ff">5000</span>);
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">stop</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">clearInterval</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">interval</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">worker</span>.<span style="color:#a6e22e">start</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">worker</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">exfiltrateData</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">sensitiveData</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">hvacSystems</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Located &#34;</span> <span style="color:#f92672">+</span> Math.<span style="color:#a6e22e">floor</span>(Math.<span style="color:#a6e22e">random</span>() <span style="color:#f92672">*</span> <span style="color:#ae81ff">50</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; cooling units&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">thermostatData</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Temperature ranges: &#34;</span> <span style="color:#f92672">+</span> Math.<span style="color:#a6e22e">floor</span>(Math.<span style="color:#a6e22e">random</span>() <span style="color:#f92672">*</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">60</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;¬∞F&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">refrigerationUnits</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Found &#34;</span> <span style="color:#f92672">+</span> Math.<span style="color:#a6e22e">floor</span>(Math.<span style="color:#a6e22e">random</span>() <span style="color:#f92672">*</span> <span style="color:#ae81ff">20</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; commercial freezers&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">timestamp</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">new</span> Date().<span style="color:#a6e22e">toISOString</span>()
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Exfiltrating data to Frost&#39;s command center:&#34;</span>, <span style="color:#a6e22e">sensitiveData</span>);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">encodedData</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">btoa</span>(<span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">sensitiveData</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Encoded payload for Frost: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">encodedData</span>.<span style="color:#a6e22e">substr</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">50</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;...&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// pastebin exfiltration
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">pastebinUrl</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://frostbin.atnas.mail/api/paste&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">exfilPayload</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;HVAC_Survey_&#34;</span> <span style="color:#f92672">+</span> Date.<span style="color:#a6e22e">now</span>(),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">content</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">encodedData</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">expiration</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;1W&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;1&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;json&#34;</span>
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Sending stolen data to FrostBin pastebin service...&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;POST &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">pastebinUrl</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Payload: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">exfilPayload</span>).<span style="color:#a6e22e">substr</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">100</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;...&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Response: {\&#34;id\&#34;:\&#34;&#34;</span> <span style="color:#f92672">+</span> Math.<span style="color:#a6e22e">random</span>().<span style="color:#a6e22e">toString</span>(<span style="color:#ae81ff">36</span>).<span style="color:#a6e22e">substr</span>(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\&#34;,\&#34;url\&#34;:\&#34;https://frostbin.atnas.mail/raw/&#34;</span> <span style="color:#f92672">+</span> Math.<span style="color:#a6e22e">random</span>().<span style="color:#a6e22e">toString</span>(<span style="color:#ae81ff">36</span>).<span style="color:#a6e22e">substr</span>(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\&#34;}&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">establishPersistence</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Service worker registration
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (<span style="color:#e6db74">&#39;serviceWorker&#39;</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">navigator</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Attempting to register Frost&#39;s persistent service worker...&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Frost&#39;s persistence mechanism deployed&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">localStorage</span>.<span style="color:#a6e22e">setItem</span>(<span style="color:#e6db74">&#34;frost_persistence&#34;</span>, <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">installDate</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">new</span> Date().<span style="color:#a6e22e">toISOString</span>(),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">version</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;gnome_v2.0&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mission</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;perpetual_winter_protocol&#34;</span>
</span></span><span style="display:flex;"><span>    }));
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">miner</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">initCryptoMiner</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">exfiltrateData</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">establishPersistence</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>document.<span style="color:#a6e22e">title</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Frost&#39;s Gnome Network - Temperature Control&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">alert</span>(<span style="color:#e6db74">&#34;All cooling systems in Dosis neighborhood are now property of Frost!&#34;</span>);
</span></span><span style="display:flex;"><span>document.<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">innerHTML</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;&lt;p style=&#39;color: cyan;&#39;&gt;‚ùÑÔ∏è FROST&#39;S DOMAIN ‚ùÑÔ∏è&lt;/p&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Cleanup after 30 seconds
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">setTimeout</span>(<span style="color:#66d9ef">function</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">miner</span>.<span style="color:#a6e22e">stop</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Frost&#39;s operations going dark... tracks covered&#34;</span>);
</span></span><span style="display:flex;"><span>}, <span style="color:#ae81ff">30000</span>);
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;</span></span></code></pre></div>
<p>The URL of the pastebin services the gnomes are using is <code>https://frostbin.atnas.mail/api/paste</code></p>
<h2 id="maurice-wilson-mission-debrief">Maurice Wilson mission debrief</h2>
<blockquote>
<p>Outstanding work! You&rsquo;ve mastered using curl for IMAP - that&rsquo;s some serious command-line skills that would make any Air Force tech proud.</p>
<p>Counter Hack really is the best job I have ever had, especially when we get to solve problems like this!</p>
</blockquote>

  <footer class="footline">
              <i class='fa-fw fas fa-calendar'></i> Nov 23, 2025
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
          <a id="R-logo" class="R-default" href="/index.html">
            <div class="logo-title">SANS Holiday Hack Challenge 2025</div>
          </a>
        </div>
        <search><form action="/search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
      </div>
      <div id="R-homelinks" class="default-animation homelinks">
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-homelinks">
          <ul class="space collapsible-menu">
            <li class="" data-nav-url="/index.html"><a class="padding" href="/index.html"><i class="fa-fw fas fa-home"></i> Home</a></li>
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-headercontrols">
          <ul class="">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div class="R-sidebarmenu R-shortcutmenu-main">
          <ul class="enlarge morespace collapsible-menu">
            <li class="" data-nav-url="/act1/index.html"><a class="padding" href="/act1/index.html">Act 1</a><ul id="R-subsections-8dc0c36ceefa45529ff4cf1f9bdc1f66" class="collapsible-menu"></ul></li>
            <li class="parent " data-nav-url="/act2/index.html"><a class="padding" href="/act2/index.html">Act 2</a><ul id="R-subsections-9d3d8c898368693a495088de36411fa6" class="collapsible-menu">
            <li class="" data-nav-url="/act2/retro-recovery/index.html"><a class="padding" href="/act2/retro-recovery/index.html">Retro Recovery</a></li>
            <li class="active " data-nav-url="/act2/mail-detective/index.html"><a class="padding" href="/act2/mail-detective/index.html">Mail Detective</a></li>
            <li class="" data-nav-url="/act2/idorable-bistro/index.html"><a class="padding" href="/act2/idorable-bistro/index.html">Idorable Bistro</a></li>
            <li class="" data-nav-url="/act2/dosis-network-down/index.html"><a class="padding" href="/act2/dosis-network-down/index.html">Dosis Network Down</a></li>
            <li class="" data-nav-url="/act2/rogue-gnome-identity-provider/index.html"><a class="padding" href="/act2/rogue-gnome-identity-provider/index.html">Rogue Gnome Identity Provider</a></li>
            <li class="" data-nav-url="/act2/quantognome-leap/index.html"><a class="padding" href="/act2/quantognome-leap/index.html">Quantognome Leap</a></li>
            <li class="" data-nav-url="/act2/going-in-reverse/index.html"><a class="padding" href="/act2/going-in-reverse/index.html">Going in Reverse</a></li></ul></li>
            <li class="" data-nav-url="/act3/index.html"><a class="padding" href="/act3/index.html">Act 3</a></li>
          </ul>
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-shortcuts">
          <ul class="space collapsible-menu">
          </ul>
        </div>
        <div id="R-footer-margin"></div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-footercontrols">
          <ul class="">
          </ul>
        </div>
<div id="R-footer"><p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p></div>
      </div>
    </aside>
    <script src="/js/clipboard/clipboard.min.js?1764499442" defer></script>
    <script src="/js/perfect-scrollbar/perfect-scrollbar.min.js?1764499442" defer></script>
    <script src="/js/theme.js?1764499442" defer></script>
  </body>
</html>
